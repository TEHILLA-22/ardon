<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CustomCraft | Bespoke Fashion & Gadgets</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #6c5ce7;
            --primary-dark: #5649c0;
            --secondary: #00cec9;
            --dark: #2d3436;
            --light: #f5f6fa;
            --gray: #dfe6e9;
            --success: #00b894;
            --warning: #fdcb6e;
            --danger: #d63031;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            --radius: 12px;
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--light);
            color: var(--dark);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header Styles */
        header {
            background-color: white;
            box-shadow: var(--shadow);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
        }

        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
        }

        .logo {
            font-family: 'Playfair Display', serif;
            font-size: 24px;
            font-weight: 700;
            color: var(--primary);
            text-decoration: none;
            display: flex;
            align-items: center;
        }

        .logo i {
            margin-right: 10px;
        }

        .nav-links {
            display: flex;
            list-style: none;
        }

        .nav-links li {
            margin-left: 30px;
        }

        .nav-links a {
            text-decoration: none;
            color: var(--dark);
            font-weight: 500;
            transition: var(--transition);
            position: relative;
        }

        .nav-links a:hover {
            color: var(--primary);
        }

        .nav-links a::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            background: var(--primary);
            bottom: -5px;
            left: 0;
            transition: var(--transition);
        }

        .nav-links a:hover::after {
            width: 100%;
        }

        .auth-buttons .btn {
            margin-left: 15px;
        }

        .btn {
            display: inline-block;
            padding: 10px 20px;
            border-radius: var(--radius);
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
            border: none;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
        }

        .btn-outline {
            background-color: transparent;
            border: 1px solid var(--primary);
            color: var(--primary);
        }

        .btn-outline:hover {
            background-color: var(--primary);
            color: white;
        }

        .btn-secondary {
            background-color: var(--secondary);
            color: white;
        }

        .btn-secondary:hover {
            background-color: #00b5ad;
            transform: translateY(-2px);
        }

        /* Hero Section */
        .hero {
            padding: 150px 0 80px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            text-align: center;
        }

        .hero h1 {
            font-family: 'Playfair Display', serif;
            font-size: 48px;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--dark);
        }

        .hero p {
            font-size: 18px;
            max-width: 700px;
            margin: 0 auto 40px;
            color: #555;
        }

        .search-bar {
            max-width: 600px;
            margin: 0 auto;
            display: flex;
            background: white;
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .search-bar input {
            flex: 1;
            padding: 15px 20px;
            border: none;
            outline: none;
            font-size: 16px;
        }

        .search-bar button {
            padding: 0 25px;
            background-color: var(--primary);
            color: white;
            border: none;
            cursor: pointer;
            transition: var(--transition);
        }

        .search-bar button:hover {
            background-color: var(--primary-dark);
        }

        /* Categories Section */
        .section {
            padding: 80px 0;
        }

        .section-title {
            text-align: center;
            margin-bottom: 50px;
        }

        .section-title h2 {
            font-family: 'Playfair Display', serif;
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 15px;
        }

        .section-title p {
            color: #666;
            max-width: 700px;
            margin: 0 auto;
        }

        .categories {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 30px;
        }

        .category-card {
            background: white;
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            cursor: pointer;
        }

        .category-card:hover {
            transform: translateY(-10px);
        }

        .category-img {
            height: 200px;
            overflow: hidden;
        }

        .category-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: var(--transition);
        }

        .category-card:hover .category-img img {
            transform: scale(1.1);
        }

        .category-info {
            padding: 20px;
            text-align: center;
        }

        .category-info h3 {
            font-size: 20px;
            margin-bottom: 10px;
        }

        .category-info p {
            color: #666;
            font-size: 14px;
        }

        /* Brands Section */
        .brands {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 30px;
            margin-top: 40px;
        }

        .brand-card {
            background: white;
            border-radius: var(--radius);
            padding: 30px;
            box-shadow: var(--shadow);
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 200px;
            transition: var(--transition);
        }

        .brand-card:hover {
            transform: translateY(-5px);
        }

        .brand-logo {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            overflow: hidden;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--light);
        }

        .brand-logo img {
            max-width: 80%;
            max-height: 80%;
            object-fit: contain;
        }

        .brand-info h3 {
            font-size: 18px;
            margin-bottom: 5px;
            text-align: center;
        }

        .brand-info p {
            color: #666;
            font-size: 14px;
            text-align: center;
        }

        /* How It Works Section */
        .steps {
            display: flex;
            justify-content: space-between;
            margin-top: 50px;
            flex-wrap: wrap;
        }

        .step {
            flex: 1;
            min-width: 250px;
            text-align: center;
            padding: 0 20px;
            margin-bottom: 30px;
            position: relative;
        }

        .step:not(:last-child)::after {
            content: '';
            position: absolute;
            top: 40px;
            right: -30px;
            width: 60px;
            height: 2px;
            background: var(--gray);
        }

        .step-icon {
            width: 80px;
            height: 80px;
            background: var(--primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            color: white;
            font-size: 30px;
        }

        .step h3 {
            font-size: 20px;
            margin-bottom: 15px;
        }

        .step p {
            color: #666;
        }

        /* Featured Products */
        .products {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 30px;
        }

        .product-card {
            background: white;
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            cursor: pointer;
        }

        .product-card:hover {
            transform: translateY(-10px);
        }

        .product-img {
            height: 250px;
            overflow: hidden;
            position: relative;
        }

        .product-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: var(--transition);
        }

        .product-card:hover .product-img img {
            transform: scale(1.1);
        }

        .product-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: var(--primary);
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }

        .product-info {
            padding: 20px;
        }

        .product-info h3 {
            font-size: 18px;
            margin-bottom: 10px;
        }

        .product-info .brand {
            font-size: 14px;
            color: var(--primary);
            margin-bottom: 10px;
            display: block;
        }

        .product-info .price {
            font-weight: 600;
            font-size: 20px;
            color: var(--dark);
            margin-bottom: 15px;
        }

        .product-info .btn {
            width: 100%;
        }

        /* Footer */
        footer {
            background: var(--dark);
            color: white;
            padding: 60px 0 20px;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }

        .footer-col h3 {
            font-family: 'Playfair Display', serif;
            font-size: 20px;
            margin-bottom: 20px;
            position: relative;
            padding-bottom: 10px;
        }

        .footer-col h3::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: 0;
            width: 50px;
            height: 2px;
            background: var(--primary);
        }

        .footer-col ul {
            list-style: none;
        }

        .footer-col ul li {
            margin-bottom: 10px;
        }

        .footer-col ul li a {
            color: #bbb;
            text-decoration: none;
            transition: var(--transition);
        }

        .footer-col ul li a:hover {
            color: white;
            padding-left: 5px;
        }

        .footer-col .social-links {
            display: flex;
            gap: 15px;
        }

        .footer-col .social-links a {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            color: white;
            transition: var(--transition);
        }

        .footer-col .social-links a:hover {
            background: var(--primary);
            transform: translateY(-3px);
        }

        .footer-bottom {
            text-align: center;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: #bbb;
            font-size: 14px;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            overflow-y: auto;
        }

        .modal-content {
            background: white;
            width: 90%;
            max-width: 800px;
            margin: 50px auto;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            animation: modalFadeIn 0.3s ease;
        }

        @keyframes modalFadeIn {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid var(--gray);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h2 {
            font-family: 'Playfair Display', serif;
            font-size: 24px;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
            transition: var(--transition);
        }

        .close-modal:hover {
            color: var(--danger);
        }

        .modal-body {
            padding: 20px;
        }

        .modal-footer {
            padding: 20px;
            border-top: 1px solid var(--gray);
            display: flex;
            justify-content: flex-end;
            gap: 15px;
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--gray);
            border-radius: var(--radius);
            font-size: 16px;
            transition: var(--transition);
        }

        .form-control:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(108, 92, 231, 0.2);
        }

        textarea.form-control {
            min-height: 120px;
            resize: vertical;
        }

        .file-upload {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 30px;
            border: 2px dashed var(--gray);
            border-radius: var(--radius);
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .file-upload:hover {
            border-color: var(--primary);
        }

        .file-upload i {
            font-size: 40px;
            color: var(--primary);
            margin-bottom: 15px;
        }

        .file-upload input {
            display: none;
        }

        .preview-image {
            max-width: 100%;
            max-height: 200px;
            margin-top: 15px;
            display: none;
            border-radius: var(--radius);
        }

        /* Dashboard Styles */
        .dashboard {
            display: flex;
            min-height: calc(100vh - 80px);
            margin-top: 80px;
        }

        .sidebar {
            width: 250px;
            background: var(--dark);
            color: white;
            padding: 30px 0;
            position: fixed;
            height: 100%;
        }

        .sidebar-header {
            padding: 0 20px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .sidebar-header h3 {
            font-family: 'Playfair Display', serif;
            font-size: 20px;
            display: flex;
            align-items: center;
        }

        .sidebar-header h3 i {
            margin-right: 10px;
        }

        .sidebar-menu {
            padding: 20px 0;
        }

        .sidebar-menu ul {
            list-style: none;
        }

        .sidebar-menu li a {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            color: #bbb;
            text-decoration: none;
            transition: var(--transition);
        }

        .sidebar-menu li a:hover, .sidebar-menu li a.active {
            color: white;
            background: rgba(255, 255, 255, 0.1);
        }

        .sidebar-menu li a i {
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }

        .main-content {
            flex: 1;
            margin-left: 250px;
            padding: 30px;
            background: var(--light);
        }

        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--gray);
        }

        .page-header h2 {
            font-family: 'Playfair Display', serif;
            font-size: 28px;
        }

        .card {
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 20px;
            margin-bottom: 30px;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--gray);
        }


        .suggestions-dropdown {
    position: absolute;
    background: white;
    width: calc(100% - 30px);
    max-height: 200px;
    overflow-y: auto;
    border: 1px solid var(--gray);
    border-radius: 0 0 var(--radius) var(--radius);
    box-shadow: var(--shadow);
    z-index: 1000;
}

.suggestion-item {
    padding: 10px 15px;
    cursor: pointer;
    transition: var(--transition);
}

.suggestion-item:hover {
    background-color: var(--light);
}

.suggestion-item.active {
    background-color: var(--primary);
    color: white;
}

        /* Add to the existing CSS */
.request-detail-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 15px;
    margin-bottom: 20px;
}

.detail-item {
    background: rgba(108, 92, 231, 0.05);
    padding: 12px;
    border-radius: var(--radius);
}

.detail-item label {
    display: block;
    font-weight: 500;
    margin-bottom: 5px;
    color: var(--primary);
}

.detail-section {
    margin-bottom: 20px;
    padding-bottom: 20px;
    border-bottom: 1px solid var(--gray);
}

.detail-section h3 {
    font-size: 18px;
    margin-bottom: 10px;
    color: var(--dark);
}

.detail-content {
    background: rgba(108, 92, 231, 0.05);
    padding: 15px;
    border-radius: var(--radius);
    white-space: pre-line;
}

.action-btn i {
    margin-right: 5px;
}

        .card-header h3 {
            font-size: 18px;
            font-weight: 600;
        }

        .table-responsive {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        table th, table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid var(--gray);
        }

        table th {
            background: var(--light);
            font-weight: 600;
        }

        table tr:hover {
            background: rgba(108, 92, 231, 0.05);
        }

        .status-badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }

        .status-pending {
            background: rgba(253, 203, 110, 0.2);
            color: #e17055;
        }

        .status-approved {
            background: rgba(0, 184, 148, 0.2);
            color: var(--success);
        }

        .status-rejected {
            background: rgba(214, 48, 49, 0.2);
            color: var(--danger);
        }

        .status-completed {
            background: rgba(108, 92, 231, 0.2);
            color: var(--primary);
        }

        .action-btn {
            padding: 5px 10px;
            border-radius: var(--radius);
            font-size: 12px;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            margin-right: 5px;
        }

        .action-btn.view {
            background: rgba(0, 206, 201, 0.2);
            color: var(--secondary);
        }

        .action-btn.edit {
            background: rgba(108, 92, 231, 0.2);
            color: var(--primary);
        }

        .action-btn.delete {
            background: rgba(214, 48, 49, 0.2);
            color: var(--danger);
        }

        .action-btn:hover {
            opacity: 0.8;
        }

        /* Responsive Styles */
        @media (max-width: 992px) {
            .steps {
                flex-direction: column;
            }
            
            .step:not(:last-child)::after {
                display: none;
            }
            
            .sidebar {
                width: 70px;
                overflow: hidden;
            }
            
            .sidebar-header h3 span, .sidebar-menu li a span {
                display: none;
            }
            
            .sidebar-menu li a i {
                margin-right: 0;
                font-size: 20px;
            }
            
            .main-content {
                margin-left: 70px;
            }
        }

        @media (max-width: 768px) {
            .navbar {
                flex-direction: column;
                padding: 15px 0;
            }
            
            .nav-links {
                margin-top: 15px;
            }
            
            .nav-links li {
                margin-left: 15px;
                margin-right: 15px;
            }
            
            .auth-buttons {
                margin-top: 15px;
            }
            
            .hero {
                padding: 120px 0 60px;
            }
            
            .hero h1 {
                font-size: 36px;
            }
            
            .section {
                padding: 60px 0;
            }
            
            .section-title h2 {
                font-size: 28px;
            }
            
            .modal-content {
                width: 95%;
                margin: 20px auto;
            }
        }

        @media (max-width: 576px) {
            .nav-links {
                flex-direction: column;
                align-items: center;
            }
            
            .nav-links li {
                margin: 5px 0;
            }
            
            .search-bar {
                flex-direction: column;
            }
            
            .search-bar input {
                width: 100%;
            }
            
            .search-bar button {
                width: 100%;
                padding: 15px;
            }
            
            .category-card, .brand-card {
                width: 100%;
            }
            
            .dashboard {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
                padding: 15px 0;
            }
            
            .sidebar-menu ul {
                display: flex;
                overflow-x: auto;
                padding: 0 10px;
            }
            
            .sidebar-menu li {
                flex-shrink: 0;
            }
            
            .sidebar-menu li a span {
                display: inline;
            }
            
            .main-content {
                margin-left: 0;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container">
            <nav class="navbar">
                <a href="#" class="logo">
                    <i class="fas fa-cut"></i>
                    <span>Ardon</span>
                </a>
                <ul class="nav-links">
                    <li><a href="#home">Home</a></li>
                    <li><a href="#categories">Categories</a></li>
                    <li><a href="#brands">Brands</a></li>
                    <li><a href="#how-it-works">How It Works</a></li>
                    <li><a href="#products">Products</a></li>
                </ul>
                <div class="auth-buttons">
                    <button class="btn btn-outline" id="loginBtn">Login</button>
                    <button class="btn btn-primary" id="registerBtn">Register</button>
                </div>
            </nav>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero" id="home">
        <div class="container">
            <h1>Create Your Perfect Custom Product</h1>
            <p>Design or customize fashion items and gadgets exactly how you want them. Connect with top brands to bring your vision to life.</p>
            <div class="search-bar">
                <input type="text" placeholder="Search for products or brands...">
                <button><i class="fas fa-search"></i></button>
            </div>
        </div>
    </section>

    <!-- Categories Section -->
    <section class="section" id="categories">
        <div class="container">
            <div class="section-title">
                <h2>Browse Categories</h2>
                <p>Choose from our wide range of customizable product categories</p>
            </div>
            <div class="categories">
                <div class="category-card" data-category="shoes">
                    <div class="category-img">
                        <img src="https://images.unsplash.com/photo-1542291026-7eec264c27ff?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Shoes">
                    </div>
                    <div class="category-info">
                        <h3>Shoes</h3>
                        <p>Custom sneakers, heels, boots and more</p>
                    </div>
                </div>
                <div class="category-card" data-category="bags">
                    <div class="category-img">
                        <img src="https://images.unsplash.com/photo-1590874103328-eac38a683ce7?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Bags">
                    </div>
                    <div class="category-info">
                        <h3>Bags</h3>
                        <p>Design your perfect handbag or backpack</p>
                    </div>
                </div>
                <div class="category-card" data-category="phones">
                    <div class="category-img">
                        <img src="https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Phones">
                    </div>
                    <div class="category-info">
                        <h3>Phones</h3>
                        <p>Custom phone cases and accessories</p>
                    </div>
                </div>
                <div class="category-card" data-category="watches">
                    <div class="category-img">
                        <img src="https://images.unsplash.com/photo-1523170335258-f5ed11844a49?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Watches">
                    </div>
                    <div class="category-info">
                        <h3>Watches</h3>
                        <p>Personalized timepieces</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Brands Section -->
    <section class="section" id="brands">
        <div class="container">
            <div class="section-title">
                <h2>Featured Brands</h2>
                <p>Partnered with the best brands to bring your custom products to life</p>
            </div>
            <div class="brands">
                <div class="brand-card" data-brand="nike">
                    <div class="brand-logo">
                        <img src="https://i.imgur.com/1Q9ZQ9r.png" alt="Nike">
                    </div>
                    <div class="brand-info">
                        <h3>Nike</h3>
                        <p>Custom footwear & apparel</p>
                    </div>
                </div>
                <div class="brand-card" data-brand="adidas">
                    <div class="brand-logo">
                        <img src="https://i.imgur.com/9Q9ZQ9r.png" alt="Adidas">
                    </div>
                    <div class="brand-info">
                        <h3>Adidas</h3>
                        <p>Personalized sportswear</p>
                    </div>
                </div>
                <div class="brand-card" data-brand="apple">
                    <div class="brand-logo">
                        <img src="https://i.imgur.com/2Q9ZQ9r.png" alt="Apple">
                    </div>
                    <div class="brand-info">
                        <h3>Apple</h3>
                        <p>Custom tech accessories</p>
                    </div>
                </div>
                <div class="brand-card" data-brand="gucci">
                    <div class="brand-logo">
                        <img src="https://i.imgur.com/3Q9ZQ9r.png" alt="Gucci">
                    </div>
                    <div class="brand-info">
                        <h3>Gucci</h3>
                        <p>Luxury custom fashion</p>
                    </div>
                </div>
                <div class="brand-card" data-brand="samsung">
                    <div class="brand-logo">
                        <img src="https://i.imgur.com/4Q9ZQ9r.png" alt="Samsung">
                    </div>
                    <div class="brand-info">
                        <h3>Samsung</h3>
                        <p>Custom phone designs</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- How It Works Section -->
    <section class="section bg-light" id="how-it-works">
        <div class="container">
            <div class="section-title">
                <h2>How It Works</h2>
                <p>Get your custom product in just a few simple steps</p>
            </div>
            <div class="steps">
                <div class="step">
                    <div class="step-icon">
                        <i class="fas fa-pencil-alt"></i>
                    </div>
                    <h3>Design Your Product</h3>
                    <p>Choose from existing products or upload your own designs with specifications.</p>
                </div>
                <div class="step">
                    <div class="step-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <h3>Get Approval</h3>
                    <p>Brands review your request and approve the feasibility of your design.</p>
                </div>
                <div class="step">
                    <div class="step-icon">
                        <i class="fas fa-dollar-sign"></i>
                    </div>
                    <h3>Receive Quote</h3>
                    <p>Once approved, you'll receive a price quote for your custom product.</p>
                </div>
                <div class="step">
                    <div class="step-icon">
                        <i class="fas fa-truck"></i>
                    </div>
                    <h3>Get Your Product</h3>
                    <p>Pay securely and your custom product will be manufactured and shipped to you.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Products Section -->
    <section class="section" id="products">
        <div class="container">
            <div class="section-title">
                <h2>Featured Custom Products</h2>
                <p>Browse popular customizable products from our partner brands</p>
            </div>
            <div class="products">
                <div class="product-card" data-product="1">
                    <div class="product-img">
                        <img src="https://images.unsplash.com/photo-1600269452121-4f2416e55c28?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Custom Sneakers">
                        <span class="product-badge">Customizable</span>
                    </div>
                    <div class="product-info">
                        <h3>Air Max Custom</h3>
                        <span class="brand">Nike</span>
                        <p>Design your perfect pair of sneakers with custom colors and materials.</p>
                        <div class="price">From $149.99</div>
                        <button class="btn btn-primary customize-btn">Customize Now</button>
                    </div>
                </div>
                <div class="product-card" data-product="2">
                    <div class="product-img">
                        <img src="https://images.unsplash.com/photo-1548036328-c9fa89d128fa?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Custom Backpack">
                        <span class="product-badge">Customizable</span>
                    </div>
                    <div class="product-info">
                        <h3>Explorer Backpack</h3>
                        <span class="brand">Adidas</span>
                        <p>Personalize your backpack with custom colors, patterns and embroidery.</p>
                        <div class="price">From $79.99</div>
                        <button class="btn btn-primary customize-btn">Customize Now</button>
                    </div>
                </div>
                <div class="product-card" data-product="3">
                    <div class="product-img">
                        <img src="https://images.unsplash.com/photo-1510557880182-3d4d3cba35a5?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Custom Phone">
                        <span class="product-badge">Customizable</span>
                    </div>
                    <div class="product-info">
                        <h3>Galaxy S22 Custom</h3>
                        <span class="brand">Samsung</span>
                        <p>Create a unique phone with custom colors, engravings and accessories.</p>
                        <div class="price">From $899.99</div>
                        <button class="btn btn-primary customize-btn">Customize Now</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="section bg-primary" style="color: white; background: linear-gradient(135deg, #6c5ce7 0%, #5649c0 100%);">
        <div class="container">
            <div class="section-title">
                <h2>Ready to Create Something Unique?</h2>
                <p style="color: rgba(255,255,255,0.8);">Start your custom product journey today</p>
            </div>
            <div style="text-align: center;">
                <button class="btn btn-secondary" style="font-size: 18px; padding: 15px 30px;" id="startDesignBtn">Start Designing</button>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <!-- Updated Footer Section -->
<footer>
    <div class="container">
        <div class="footer-content">
            <div class="footer-col">
                <h3>CustomCraft</h3>
                <p style="color: #bbb; margin-bottom: 20px;">The premier platform for custom fashion and gadget designs, connecting creators with top brands.</p>
                <div class="social-links">
                    <a href="#"><i class="fab fa-facebook-f"></i></a>
                    <a href="#"><i class="fab fa-twitter"></i></a>
                    <a href="#"><i class="fab fa-instagram"></i></a>
                    <a href="#"><i class="fab fa-pinterest"></i></a>
                </div>
            </div>
            <div class="footer-col">
                <h3>Quick Links</h3>
                <ul>
                    <li><a href="#home">Home</a></li>
                    <li><a href="#categories">Categories</a></li>
                    <li><a href="#brands">Brands</a></li>
                    <li><a href="#how-it-works">How It Works</a></li>
                    <li><a href="#products">Products</a></li>
                </ul>
            </div>
            <div class="footer-col">
                <h3>Customer Service</h3>
                <ul>
                    <li><a href="#" id="contactLink">Contact Us</a></li>
                    <li><a href="#" id="faqLink">FAQs</a></li>
                    <li><a href="#" id="shippingLink">Shipping Policy</a></li>
                    <li><a href="#" id="returnsLink">Returns & Refunds</a></li>
                    <li><a href="#" id="termsLink">Terms of Service</a></li>
                </ul>
            </div>
            <div class="footer-col">
                <h3>Newsletter</h3>
                <p style="color: #bbb; margin-bottom: 20px;">Subscribe to get updates on new products and special offers.</p>
                <div class="search-bar" style="background: transparent; box-shadow: none;">
                    <input type="email" placeholder="Your email address" style="background: rgba(255,255,255,0.1); color: white;">
                    <button style="background: var(--secondary);"><i class="fas fa-paper-plane"></i></button>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2023 CustomCraft. All rights reserved.</p>
        </div>
    </div>
</footer>

    <!-- Login Modal -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Login to Your Account</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="loginForm">
                    <div class="form-group">
                        <label for="loginEmail">Email Address</label>
                        <input type="email" id="loginEmail" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">Password</label>
                        <input type="password" id="loginPassword" class="form-control" required>
                    </div>
                    <div class="form-group" style="text-align: right;">
                        <a href="#" style="color: var(--primary); text-decoration: none;">Forgot Password?</a>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline close-modal">Cancel</button>
                <button class="btn btn-primary" id="submitLogin">Login</button>
            </div>
        </div>
    </div>

    <!-- Register Modal -->
    <div class="modal" id="registerModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Create an Account</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="registerForm">
                    <div class="form-group">
                        <label for="registerName">Full Name</label>
                        <input type="text" id="registerName" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="registerEmail">Email Address</label>
                        <input type="email" id="registerEmail" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="registerPassword">Password</label>
                        <input type="password" id="registerPassword" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="registerConfirm">Confirm Password</label>
                        <input type="password" id="registerConfirm" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" required> I agree to the <a href="#" style="color: var(--primary);">Terms of Service</a> and <a href="#" style="color: var(--primary);">Privacy Policy</a>
                        </label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline close-modal">Cancel</button>
                <button class="btn btn-primary" id="submitRegister">Register</button>
            </div>
        </div>
    </div>

    <!-- Customization Modal -->
    <div class="modal" id="customizeModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Customize Your Product</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="customizeForm">
                   <!-- Replace the product and brand input fields in the customizeModal -->
<div class="form-group">
    <label for="customProductName">Product Name</label>
    <input type="text" id="customProductName" class="form-control" placeholder="Enter product name or select from catalog">
    <div id="productSuggestions" class="suggestions-dropdown" style="display: none;"></div>
</div>
<div class="form-group">
    <label for="customBrandName">Brand Name</label>
    <input type="text" id="customBrandName" class="form-control" placeholder="Enter brand name or select from catalog">
    <div id="brandSuggestions" class="suggestions-dropdown" style="display: none;"></div>
</div>
                    <div class="form-group">
                        <label for="customDescription">Customization Details</label>
                        <textarea id="customDescription" class="form-control" placeholder="Describe exactly how you want your product customized. Include colors, materials, engravings, etc." required></textarea>
                    </div>
                    <div class="form-group">
                        <label>Upload Design Files (Optional)</label>
                        <div class="file-upload" id="designUpload">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Click to upload design files or images</p>
                            <input type="file" id="designFiles" accept="image/*,.pdf,.ai,.psd" multiple>
                            <img id="previewImage" class="preview-image" alt="Preview">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="customNotes">Additional Notes</label>
                        <textarea id="customNotes" class="form-control" placeholder="Any special instructions or requirements..."></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline close-modal">Cancel</button>
                <button class="btn btn-primary" id="submitCustomization">Submit Request</button>
            </div>
        </div>
    </div>

    <!-- Dashboard (Hidden by default) -->
    <div class="dashboard" id="dashboard" style="display: none;">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h3><i class="fas fa-user-circle"></i> <span id="sidebarUsername">John Doe</span></h3>
            </div>
            <div class="sidebar-menu">
                <ul>
                    <li><a href="#" class="active" data-section="overview"><i class="fas fa-tachometer-alt"></i> <span>Overview</span></a></li>
                    <li><a href="#" data-section="requests"><i class="fas fa-pencil-alt"></i> <span>My Requests</span></a></li>
                    <li><a href="#" data-section="orders"><i class="fas fa-shopping-bag"></i> <span>Orders</span></a></li>
                    <li><a href="#" data-section="messages"><i class="fas fa-envelope"></i> <span>Messages</span></a></li>
                    <li><a href="#" data-section="settings"><i class="fas fa-cog"></i> <span>Settings</span></a></li>
                    <li><a href="#" id="logoutBtn"><i class="fas fa-sign-out-alt"></i> <span>Logout</span></a></li>
                </ul>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Overview Section -->
            <div class="dashboard-section" id="overview-section">
                <div class="page-header">
                    <h2>Dashboard Overview</h2>
                    <button class="btn btn-primary" id="newRequestBtn">+ New Request</button>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3>Recent Activity</h3>
                    </div>
                    <div class="table-responsive">
                        <table>
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Activity</th>
                                    <th>Status</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody id="recentActivityTable">
                                <!-- Filled by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3>Pending Requests</h3>
                    </div>
                    <div class="table-responsive">
                        <table>
                            <thead>
                                <tr>
                                    <th>Request ID</th>
                                    <th>Product</th>
                                    <th>Brand</th>
                                    <th>Submitted</th>
                                    <th>Status</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody id="pendingRequestsTable">
                                <!-- Filled by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- My Requests Section -->
            <div class="dashboard-section" id="requests-section" style="display: none;">
                <div class="page-header">
                    <h2>My Customization Requests</h2>
                    <button class="btn btn-primary" id="newRequestBtn2">+ New Request</button>
                </div>
                
                <div class="card">
                    <div class="table-responsive">
                        <table>
                            <thead>
                                <tr>
                                    <th>Request ID</th>
                                    <th>Product</th>
                                    <th>Brand</th>
                                    <th>Submitted</th>
                                    <th>Status</th>
                                    <th>Quote</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody id="allRequestsTable">
                                <!-- Filled by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- Orders Section -->
            <div class="dashboard-section" id="orders-section" style="display: none;">
                <div class="page-header">
                    <h2>My Orders</h2>
                </div>
                
                <div class="card">
                    <div class="table-responsive">
                        <table>
                            <thead>
                                <tr>
                                    <th>Order ID</th>
                                    <th>Product</th>
                                    <th>Brand</th>
                                    <th>Date</th>
                                    <th>Amount</th>
                                    <th>Status</th>
                                    <th>Tracking</th>
                                </tr>
                            </thead>
                            <tbody id="ordersTable">
                                <!-- Filled by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- Messages Section -->
            <div class="dashboard-section" id="messages-section" style="display: none;">
                <div class="page-header">
                    <h2>Messages</h2>
                </div>
                
                <div class="card">
                    <div class="table-responsive">
                        <table>
                            <thead>
                                <tr>
                                    <th>From</th>
                                    <th>Subject</th>
                                    <th>Date</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody id="messagesTable">
                                <!-- Filled by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- Settings Section -->
            <div class="dashboard-section" id="settings-section" style="display: none;">
                <div class="page-header">
                    <h2>Account Settings</h2>
                </div>
                
                <div class="card">
                    <form id="settingsForm">
                        <div class="form-group">
                            <label for="settingsName">Full Name</label>
                            <input type="text" id="settingsName" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="settingsEmail">Email Address</label>
                            <input type="email" id="settingsEmail" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="settingsPhone">Phone Number</label>
                            <input type="tel" id="settingsPhone" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="settingsAddress">Shipping Address</label>
                            <textarea id="settingsAddress" class="form-control" rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <button type="submit" class="btn btn-primary">Update Profile</button>
                        </div>
                    </form>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3>Change Password</h3>
                    </div>
                    <form id="passwordForm">
                        <div class="form-group">
                            <label for="currentPassword">Current Password</label>
                            <input type="password" id="currentPassword" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="newPassword">New Password</label>
                            <input type="password" id="newPassword" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="confirmPassword">Confirm New Password</label>
                            <input type="password" id="confirmPassword" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <button type="submit" class="btn btn-primary">Change Password</button>
                        </div>
                    </form>
                </div>
            </div>
            
            <!-- Request Detail Modal -->
            <div class="modal" id="requestDetailModal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2>Request Details</h2>
                        <button class="close-modal">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label>Request ID</label>
                            <input type="text" id="detailRequestId" class="form-control" readonly>
                        </div>
                        <div class="form-group">
                            <label>Product</label>
                            <input type="text" id="detailProduct" class="form-control" readonly>
                        </div>
                        <div class="form-group">
                            <label>Brand</label>
                            <input type="text" id="detailBrand" class="form-control" readonly>
                        </div>
                        <div class="form-group">
                            <label>Status</label>
                            <input type="text" id="detailStatus" class="form-control" readonly>
                        </div>
                        <div class="form-group">
                            <label>Submitted On</label>
                            <input type="text" id="detailSubmitted" class="form-control" readonly>
                        </div>
                        <div class="form-group">
                            <label>Customization Details</label>
                            <textarea id="detailDescription" class="form-control" readonly></textarea>
                        </div>
                        <div class="form-group">
                            <label>Brand Response</label>
                            <textarea id="detailResponse" class="form-control" readonly></textarea>
                        </div>
                        <div class="form-group">
                            <label>Quote Amount</label>
                            <input type="text" id="detailQuote" class="form-control" readonly>
                        </div>
                        <div id="paymentSection" style="display: none;">
                            <div class="form-group">
                                <label>Payment Method</label>
                                <select id="paymentMethod" class="form-control">
                                    <option value="credit">Credit Card</option>
                                    <option value="debit">Debit Card</option>
                                    <option value="bank">Bank Transfer</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <button class="btn btn-primary" id="payNowBtn">Pay Now</button>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-outline close-modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Brand Dashboard (Hidden by default) -->
    <div class="dashboard" id="brandDashboard" style="display: none;">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h3><i class="fas fa-store"></i> <span id="brandSidebarName">Nike</span></h3>
            </div>
            <div class="sidebar-menu">
                <ul>
                    <li><a href="#" class="active" data-section="brand-overview"><i class="fas fa-tachometer-alt"></i> <span>Overview</span></a></li>
                    <li><a href="#" data-section="brand-requests"><i class="fas fa-pencil-alt"></i> <span>Requests</span></a></li>
                    <li><a href="#" data-section="brand-orders"><i class="fas fa-shopping-bag"></i> <span>Orders</span></a></li>
                    <li><a href="#" data-section="brand-products"><i class="fas fa-box-open"></i> <span>Products</span></a></li>
                    <li><a href="#" data-section="brand-settings"><i class="fas fa-cog"></i> <span>Settings</span></a></li>
                    <li><a href="#" id="brandLogoutBtn"><i class="fas fa-sign-out-alt"></i> <span>Logout</span></a></li>
                </ul>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Brand Overview Section -->
            <div class="dashboard-section" id="brand-overview-section">
                <div class="page-header">
                    <h2>Brand Dashboard</h2>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3>Statistics</h3>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; padding: 20px;">
                        <div style="background: rgba(108, 92, 231, 0.1); padding: 20px; border-radius: var(--radius); text-align: center;">
                            <h3 style="font-size: 24px; color: var(--primary);" id="pendingRequestsCount">0</h3>
                            <p style="color: #666;">Pending Requests</p>
                        </div>
                        <div style="background: rgba(0, 184, 148, 0.1); padding: 20px; border-radius: var(--radius); text-align: center;">
                            <h3 style="font-size: 24px; color: var(--success);" id="completedOrdersCount">0</h3>
                            <p style="color: #666;">Completed Orders</p>
                        </div>
                        <div style="background: rgba(253, 203, 110, 0.1); padding: 20px; border-radius: var(--radius); text-align: center;">
                            <h3 style="font-size: 24px; color: #e17055;" id="totalRevenueCount">$0</h3>
                            <p style="color: #666;">Total Revenue</p>
                        </div>
                        <div style="background: rgba(0, 206, 201, 0.1); padding: 20px; border-radius: var(--radius); text-align: center;">
                            <h3 style="font-size: 24px; color: var(--secondary);" id="platformCommissionCount">$0</h3>
                            <p style="color: #666;">Platform Commission</p>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3>Recent Requests</h3>
                    </div>
                    <div class="table-responsive">
                        <table>
                            <thead>
                                <tr>
                                    <th>Request ID</th>
                                    <th>Product</th>
                                    <th>Customer</th>
                                    <th>Submitted</th>
                                    <th>Status</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody id="brandRecentRequestsTable">
                                <!-- Filled by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- Brand Requests Section -->
            <div class="dashboard-section" id="brand-requests-section" style="display: none;">
                <div class="page-header">
                    <h2>Customization Requests</h2>
                </div>
                
                <div class="card">
                    <div class="table-responsive">
                        <table>
                            <thead>
                                <tr>
                                    <th>Request ID</th>
                                    <th>Product</th>
                                    <th>Customer</th>
                                    <th>Submitted</th>
                                    <th>Status</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody id="brandAllRequestsTable">
                                <!-- Filled by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- Brand Orders Section -->
            <div class="dashboard-section" id="brand-orders-section" style="display: none;">
                <div class="page-header">
                    <h2>Orders</h2>
                </div>
                
                <div class="card">
                    <div class="table-responsive">
                        <table>
                            <thead>
                                <tr>
                                    <th>Order ID</th>
                                    <th>Product</th>
                                    <th>Customer</th>
                                    <th>Date</th>
                                    <th>Amount</th>
                                    <th>Status</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody id="brandOrdersTable">
                                <!-- Filled by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- Brand Products Section -->
            <div class="dashboard-section" id="brand-products-section" style="display: none;">
                <div class="page-header">
                    <h2>Product Catalog</h2>
                    <button class="btn btn-primary" id="addProductBtn">+ Add Product</button>
                </div>
                
                <div class="card">
                    <div class="table-responsive">
                        <table>
                            <thead>
                                <tr>
                                    <th>Product ID</th>
                                    <th>Name</th>
                                    <th>Category</th>
                                    <th>Base Price</th>
                                    <th>Status</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody id="brandProductsTable">
                                <!-- Filled by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- Brand Settings Section -->
            <div class="dashboard-section" id="brand-settings-section" style="display: none;">
                <div class="page-header">
                    <h2>Brand Settings</h2>
                </div>
                
                <div class="card">
                    <form id="brandSettingsForm">
                        <div class="form-group">
                            <label for="brandName">Brand Name</label>
                            <input type="text" id="brandName" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="brandDescription">Description</label>
                            <textarea id="brandDescription" class="form-control" rows="3" required></textarea>
                        </div>
                        <div class="form-group">
                            <label for="brandLogo">Logo</label>
                            <div class="file-upload" id="brandLogoUpload">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <p>Click to upload brand logo</p>
                                <input type="file" id="brandLogo" accept="image/*">
                                <img id="brandLogoPreview" class="preview-image" alt="Brand Logo Preview">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="brandCategories">Categories</label>
                            <select id="brandCategories" class="form-control" multiple>
                                <option value="shoes">Shoes</option>
                                <option value="bags">Bags</option>
                                <option value="clothing">Clothing</option>
                                <option value="watches">Watches</option>
                                <option value="phones">Phones</option>
                                <option value="accessories">Accessories</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <button type="submit" class="btn btn-primary">Update Brand</button>
                        </div>
                    </form>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3>Payment Information</h3>
                    </div>
                    <form id="brandPaymentForm">
                        <div class="form-group">
                            <label for="bankName">Bank Name</label>
                            <input type="text" id="bankName" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="accountName">Account Name</label>
                            <input type="text" id="accountName" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="accountNumber">Account Number</label>
                            <input type="text" id="accountNumber" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="routingNumber">Routing Number</label>
                            <input type="text" id="routingNumber" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <button type="submit" class="btn btn-primary">Update Payment Info</button>
                        </div>
                    </form>
                </div>
            </div>
            
            <!-- Brand Request Detail Modal -->
            <div class="modal" id="brandRequestDetailModal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2>Request Details</h2>
                        <button class="close-modal">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label>Request ID</label>
                            <input type="text" id="brandDetailRequestId" class="form-control" readonly>
                        </div>
                        <div class="form-group">
                            <label>Product</label>
                            <input type="text" id="brandDetailProduct" class="form-control" readonly>
                        </div>
                        <div class="form-group">
                            <label>Customer</label>
                            <input type="text" id="brandDetailCustomer" class="form-control" readonly>
                        </div>
                        <div class="form-group">
                            <label>Submitted On</label>
                            <input type="text" id="brandDetailSubmitted" class="form-control" readonly>
                        </div>
                        <div class="form-group">
                            <label>Status</label>
                            <select id="brandDetailStatus" class="form-control">
                                <option value="pending">Pending</option>
                                <option value="approved">Approved</option>
                                <option value="rejected">Rejected</option>
                                <option value="completed">Completed</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Customization Details</label>
                            <textarea id="brandDetailDescription" class="form-control" readonly></textarea>
                        </div>
                        <div class="form-group">
                            <label>Design Files</label>
                            <div id="brandDesignFiles" style="padding: 15px; border: 1px dashed var(--gray); border-radius: var(--radius);">
                                No files uploaded
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="brandDetailResponse">Your Response</label>
                            <textarea id="brandDetailResponse" class="form-control" placeholder="Provide feedback or details about feasibility..."></textarea>
                        </div>
                        <div class="form-group">
                            <label for="brandDetailQuote">Quote Amount ($)</label>
                            <input type="number" id="brandDetailQuote" class="form-control" placeholder="Enter the price for this customization">
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-outline close-modal">Cancel</button>
                        <button class="btn btn-primary" id="saveBrandRequestBtn">Save Changes</button>
                    </div>
                </div>
            </div>
            
            <!-- Add Product Modal -->
            <div class="modal" id="addProductModal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2>Add New Product</h2>
                        <button class="close-modal">&times;</button>
                    </div>
                    <div class="modal-body">
                        <form id="addProductForm">
                            <div class="form-group">
                                <label for="productName">Product Name</label>
                                <input type="text" id="productName" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="productCategory">Category</label>
                                <select id="productCategory" class="form-control" required>
                                    <option value="">Select Category</option>
                                    <option value="shoes">Shoes</option>
                                    <option value="bags">Bags</option>
                                    <option value="clothing">Clothing</option>
                                    <option value="watches">Watches</option>
                                    <option value="phones">Phones</option>
                                    <option value="accessories">Accessories</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="productDescription">Description</label>
                                <textarea id="productDescription" class="form-control" rows="3" required></textarea>
                            </div>
                            <div class="form-group">
                                <label for="productBasePrice">Base Price ($)</label>
                                <input type="number" id="productBasePrice" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="productImages">Product Images</label>
                                <div class="file-upload" id="productImagesUpload">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                    <p>Click to upload product images</p>
                                    <input type="file" id="productImages" accept="image/*" multiple>
                                    <div id="productImagesPreview" style="display: flex; flex-wrap: wrap; gap: 10px; margin-top: 15px;"></div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="productCustomOptions">Customization Options</label>
                                <textarea id="productCustomOptions" class="form-control" rows="3" placeholder="Describe what can be customized on this product (colors, materials, engravings, etc.)"></textarea>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-outline close-modal">Cancel</button>
                        <button class="btn btn-primary" id="submitProductBtn">Add Product</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Dashboard (Hidden by default) -->
    <div class="dashboard" id="adminDashboard" style="display: none;">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h3><i class="fas fa-user-shield"></i> <span>Admin</span></h3>
            </div>
            <div class="sidebar-menu">
                <ul>
                    <li><a href="#" class="active" data-section="admin-overview"><i class="fas fa-tachometer-alt"></i> <span>Overview</span></a></li>
                    <li><a href="#" data-section="admin-transactions"><i class="fas fa-money-bill-wave"></i> <span>Transactions</span></a></li>
                    <li><a href="#" data-section="admin-brands"><i class="fas fa-store"></i> <span>Brands</span></a></li>
                    <li><a href="#" data-section="admin-users"><i class="fas fa-users"></i> <span>Users</span></a></li>
                    <li><a href="#" data-section="admin-settings"><i class="fas fa-cog"></i> <span>Settings</span></a></li>
                    <li><a href="#" id="adminLogoutBtn"><i class="fas fa-sign-out-alt"></i> <span>Logout</span></a></li>
                </ul>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Admin Overview Section -->
            <div class="dashboard-section" id="admin-overview-section">
                <div class="page-header">
                    <h2>Admin Dashboard</h2>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3>Platform Statistics</h3>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; padding: 20px;">
                        <div style="background: rgba(108, 92, 231, 0.1); padding: 20px; border-radius: var(--radius); text-align: center;">
                            <h3 style="font-size: 24px; color: var(--primary);" id="totalTransactionsCount">0</h3>
                            <p style="color: #666;">Total Transactions</p>
                        </div>
                        <div style="background: rgba(0, 184, 148, 0.1); padding: 20px; border-radius: var(--radius); text-align: center;">
                            <h3 style="font-size: 24px; color: var(--success);" id="totalCommissionCount">$0</h3>
                            <p style="color: #666;">Total Commission</p>
                        </div>
                        <div style="background: rgba(253, 203, 110, 0.1); padding: 20px; border-radius: var(--radius); text-align: center;">
                            <h3 style="font-size: 24px; color: #e17055;" id="totalBrandsCount">0</h3>
                            <p style="color: #666;">Registered Brands</p>
                        </div>
                        <div style="background: rgba(0, 206, 201, 0.1); padding: 20px; border-radius: var(--radius); text-align: center;">
                            <h3 style="font-size: 24px; color: var(--secondary);" id="totalUsersCount">0</h3>
                            <p style="color: #666;">Registered Users</p>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3>Recent Transactions</h3>
                    </div>
                    <div class="table-responsive">
                        <table>
                            <thead>
                                <tr>
                                    <th>Transaction ID</th>
                                    <th>Order</th>
                                    <th>Customer</th>
                                    <th>Brand</th>
                                    <th>Amount</th>
                                    <th>Commission</th>
                                    <th>Date</th>
                                </tr>
                            </thead>
                            <tbody id="adminRecentTransactionsTable">
                                <!-- Filled by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- Admin Transactions Section -->
            <div class="dashboard-section" id="admin-transactions-section" style="display: none;">
                <div class="page-header">
                    <h2>All Transactions</h2>
                </div>
                
                <div class="card">
                    <div class="table-responsive">
                        <table>
                            <thead>
                                <tr>
                                    <th>Transaction ID</th>
                                    <th>Order</th>
                                    <th>Customer</th>
                                    <th>Brand</th>
                                    <th>Amount</th>
                                    <th>Commission</th>
                                    <th>Date</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="adminAllTransactionsTable">
                                <!-- Filled by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- Admin Brands Section -->
            <div class="dashboard-section" id="admin-brands-section" style="display: none;">
                <div class="page-header">
                    <h2>Brand Management</h2>
                    <button class="btn btn-primary" id="addBrandBtn">+ Add Brand</button>
                </div>
                
                <div class="card">
                    <div class="table-responsive">
                        <table>
                            <thead>
                                <tr>
                                    <th>Brand ID</th>
                                    <th>Name</th>
                                    <th>Categories</th>
                                    <th>Products</th>
                                    <th>Orders</th>
                                    <th>Joined</th>
                                    <th>Status</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody id="adminBrandsTable">
                                <!-- Filled by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- Admin Users Section -->
            <div class="dashboard-section" id="admin-users-section" style="display: none;">
                <div class="page-header">
                    <h2>User Management</h2>
                </div>
                
                <div class="card">
                    <div class="table-responsive">
                        <table>
                            <thead>
                                <tr>
                                    <th>User ID</th>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Requests</th>
                                    <th>Orders</th>
                                    <th>Joined</th>
                                    <th>Status</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody id="adminUsersTable">
                                <!-- Filled by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- Admin Settings Section -->
            <div class="dashboard-section" id="admin-settings-section" style="display: none;">
                <div class="page-header">
                    <h2>Platform Settings</h2>
                </div>
                
                <div class="card">
                    <form id="adminSettingsForm">
                        <div class="form-group">
                            <label for="platformName">Platform Name</label>
                            <input type="text" id="platformName" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="platformCommission">Commission Rate (%)</label>
                            <input type="number" id="platformCommission" class="form-control" step="0.1" min="0" max="100" required>
                        </div>
                        <div class="form-group">
                            <label for="platformCurrency">Currency</label>
                            <select id="platformCurrency" class="form-control" required>
                                <option value="USD">US Dollar ($)</option>
                                <option value="EUR">Euro (€)</option>
                                <option value="GBP">British Pound (£)</option>
                                <option value="JPY">Japanese Yen (¥)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="platformLogo">Platform Logo</label>
                            <div class="file-upload" id="platformLogoUpload">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <p>Click to upload platform logo</p>
                                <input type="file" id="platformLogo" accept="image/*">
                                <img id="platformLogoPreview" class="preview-image" alt="Platform Logo Preview">
                            </div>
                        </div>
                        <div class="form-group">
                            <button type="submit" class="btn btn-primary">Save Settings</button>
                        </div>
                    </form>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3>Payment Settings</h3>
                    </div>
                    <form id="adminPaymentForm">
                        <div class="form-group">
                            <label for="paymentMethods">Enabled Payment Methods</label>
                            <div style="display: flex; flex-wrap: wrap; gap: 15px; margin-top: 10px;">
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="checkbox" name="paymentMethods" value="credit" checked> Credit Card
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="checkbox" name="paymentMethods" value="debit" checked> Debit Card
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="checkbox" name="paymentMethods" value="paypal"> PayPal
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="checkbox" name="paymentMethods" value="bank"> Bank Transfer
                                </label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="stripeKey">Stripe API Key</label>
                            <input type="text" id="stripeKey" class="form-control" placeholder="pk_test_...">
                        </div>
                        <div class="form-group">
                            <label for="paypalKey">PayPal Client ID</label>
                            <input type="text" id="paypalKey" class="form-control" placeholder="AeA...">
                        </div>
                        <div class="form-group">
                            <button type="submit" class="btn btn-primary">Save Payment Settings</button>
                        </div>
                    </form>
                </div>
            </div>
            
            <!-- Add Brand Modal -->
            <div class="modal" id="addBrandModal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2>Add New Brand</h2>
                        <button class="close-modal">&times;</button>
                    </div>
                    <div class="modal-body">
                        <form id="addBrandForm">
                            <div class="form-group">
                                <label for="newBrandName">Brand Name</label>
                                <input type="text" id="newBrandName" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="newBrandEmail">Contact Email</label>
                                <input type="email" id="newBrandEmail" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="newBrandPassword">Password</label>
                                <input type="password" id="newBrandPassword" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="newBrandDescription">Description</label>
                                <textarea id="newBrandDescription" class="form-control" rows="3" required></textarea>
                            </div>
                            <div class="form-group">
                                <label for="newBrandCategories">Categories</label>
                                <select id="newBrandCategories" class="form-control" multiple>
                                    <option value="shoes">Shoes</option>
                                    <option value="bags">Bags</option>
                                    <option value="clothing">Clothing</option>
                                    <option value="watches">Watches</option>
                                    <option value="phones">Phones</option>
                                    <option value="accessories">Accessories</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="newBrandLogo">Logo</label>
                                <div class="file-upload" id="newBrandLogoUpload">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                    <p>Click to upload brand logo</p>
                                    <input type="file" id="newBrandLogo" accept="image/*">
                                    <img id="newBrandLogoPreview" class="preview-image" alt="Brand Logo Preview">
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-outline close-modal">Cancel</button>
                        <button class="btn btn-primary" id="submitBrandBtn">Add Brand</button>
                    </div>
                </div>
            </div>
            
            <!-- Brand Detail Modal -->
            <div class="modal" id="brandDetailModal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2>Brand Details</h2>
                        <button class="close-modal">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label>Brand ID</label>
                            <input type="text" id="adminBrandId" class="form-control" readonly>
                        </div>
                        <div class="form-group">
                            <label>Brand Name</label>
                            <input type="text" id="adminBrandName" class="form-control">
                        </div>
                        <div class="form-group">
                            <label>Contact Email</label>
                            <input type="email" id="adminBrandEmail" class="form-control">
                        </div>
                        <div class="form-group">
                            <label>Description</label>
                            <textarea id="adminBrandDescription" class="form-control" rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Categories</label>
                            <div id="adminBrandCategories" style="display: flex; flex-wrap: wrap; gap: 5px; padding: 10px; border: 1px solid var(--gray); border-radius: var(--radius);">
                                <!-- Categories will be added here -->
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Logo</label>
                            <img id="adminBrandLogo" class="preview-image" alt="Brand Logo" style="max-height: 100px;">
                        </div>
                        <div class="form-group">
                            <label>Status</label>
                            <select id="adminBrandStatus" class="form-control">
                                <option value="active">Active</option>
                                <option value="pending">Pending</option>
                                <option value="suspended">Suspended</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Joined Date</label>
                            <input type="text" id="adminBrandJoined" class="form-control" readonly>
                        </div>
                        <div class="form-group">
                            <label>Total Revenue</label>
                            <input type="text" id="adminBrandRevenue" class="form-control" readonly>
                        </div>
                        <div class="form-group">
                            <label>Platform Commission</label>
                            <input type="text" id="adminBrandCommission" class="form-control" readonly>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-outline close-modal">Cancel</button>
                        <button class="btn btn-primary" id="saveAdminBrandBtn">Save Changes</button>
                    </div>
                </div>
            </div>
            
            <!-- User Detail Modal -->
            <div class="modal" id="userDetailModal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2>User Details</h2>
                        <button class="close-modal">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label>User ID</label>
                            <input type="text" id="adminUserId" class="form-control" readonly>
                        </div>
                        <div class="form-group">
                            <label>Full Name</label>
                            <input type="text" id="adminUserName" class="form-control">
                        </div>
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" id="adminUserEmail" class="form-control">
                        </div>
                        <div class="form-group">
                            <label>Phone</label>
                            <input type="tel" id="adminUserPhone" class="form-control">
                        </div>
                        <div class="form-group">
                            <label>Address</label>
                            <textarea id="adminUserAddress" class="form-control" rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Joined Date</label>
                            <input type="text" id="adminUserJoined" class="form-control" readonly>
                        </div>
                        <div class="form-group">
                            <label>Total Orders</label>
                            <input type="text" id="adminUserOrders" class="form-control" readonly>
                        </div>
                        <div class="form-group">
                            <label>Total Spent</label>
                            <input type="text" id="adminUserSpent" class="form-control" readonly>
                        </div>
                        <div class="form-group">
                            <label>Status</label>
                            <select id="adminUserStatus" class="form-control">
                                <option value="active">Active</option>
                                <option value="inactive">Inactive</option>
                                <option value="banned">Banned</option>
                            </select>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-outline close-modal">Cancel</button>
                        <button class="btn btn-primary" id="saveAdminUserBtn">Save Changes</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Notification -->
    <div id="successNotification" style="position: fixed; bottom: 20px; right: 20px; background: var(--success); color: white; padding: 15px 25px; border-radius: var(--radius); box-shadow: var(--shadow); display: none; z-index: 3000;">
        <i class="fas fa-check-circle"></i> <span id="successMessage">Operation completed successfully!</span>
    </div>

    <!-- Error Notification -->
    <div id="errorNotification" style="position: fixed; bottom: 20px; right: 20px; background: var(--danger); color: white; padding: 15px 25px; border-radius: var(--radius); box-shadow: var(--shadow); display: none; z-index: 3000;">
        <i class="fas fa-exclamation-circle"></i> <span id="errorMessage">An error occurred!</span>
    </div>

    <script>
        // Database Implementation using IndexedDB
        let db;
        const DB_NAME = 'CustomCraftDB';
        const DB_VERSION = 1;

        // Open or create database
        const request = indexedDB.open(DB_NAME, DB_VERSION);

        request.onerror = function(event) {
            console.error('Database error:', event.target.error);
            showError('Failed to open database');
        };

        request.onsuccess = function(event) {
            db = event.target.result;
            console.log('Database opened successfully');
            initializeApp();
        };

        request.onupgradeneeded = function(event) {
            const db = event.target.result;
            
            // Create users store
            const usersStore = db.createObjectStore('users', { keyPath: 'id', autoIncrement: true });
            usersStore.createIndex('email', 'email', { unique: true });
            
            // Create brands store
            const brandsStore = db.createObjectStore('brands', { keyPath: 'id', autoIncrement: true });
            brandsStore.createIndex('name', 'name', { unique: true });
            brandsStore.createIndex('email', 'email', { unique: true });
            
            // Create products store
            const productsStore = db.createObjectStore('products', { keyPath: 'id', autoIncrement: true });
            productsStore.createIndex('brandId', 'brandId', { unique: false });
            productsStore.createIndex('category', 'category', { unique: false });
            
            // Create requests store
            const requestsStore = db.createObjectStore('requests', { keyPath: 'id', autoIncrement: true });
            requestsStore.createIndex('userId', 'userId', { unique: false });
            requestsStore.createIndex('brandId', 'brandId', { unique: false });
            requestsStore.createIndex('productId', 'productId', { unique: false });
            requestsStore.createIndex('status', 'status', { unique: false });
            
            // Create orders store
            const ordersStore = db.createObjectStore('orders', { keyPath: 'id', autoIncrement: true });
            ordersStore.createIndex('userId', 'userId', { unique: false });
            ordersStore.createIndex('brandId', 'brandId', { unique: false });
            ordersStore.createIndex('requestId', 'requestId', { unique: false });
            ordersStore.createIndex('status', 'status', { unique: false });
            
            // Create transactions store
            const transactionsStore = db.createObjectStore('transactions', { keyPath: 'id', autoIncrement: true });
            transactionsStore.createIndex('orderId', 'orderId', { unique: true });
            transactionsStore.createIndex('userId', 'userId', { unique: false });
            transactionsStore.createIndex('brandId', 'brandId', { unique: false });
            transactionsStore.createIndex('date', 'date', { unique: false });
            
            // Create messages store
            const messagesStore = db.createObjectStore('messages', { keyPath: 'id', autoIncrement: true });
            messagesStore.createIndex('fromId', 'fromId', { unique: false });
            messagesStore.createIndex('toId', 'toId', { unique: false });
            messagesStore.createIndex('requestId', 'requestId', { unique: false });
            
            // Create admin settings store
            const settingsStore = db.createObjectStore('settings', { keyPath: 'id' });
            
            console.log('Database structure created');
        };

        // Initialize the application after database is ready
        function initializeApp() {
            // Check if we need to seed initial data
            checkAndSeedInitialData();
            
            // Check if user is logged in
            checkAuthState();
            
            // Setup event listeners
            setupEventListeners();
        }

        // Seed initial data if database is empty
        function checkAndSeedInitialData() {
            const transaction = db.transaction(['users', 'brands', 'products', 'settings'], 'readonly');
            
            // Check if admin user exists
            const usersStore = transaction.objectStore('users');
            const usersRequest = usersStore.count();
            
            usersRequest.onsuccess = function() {
                if (usersRequest.result === 0) {
                    // Database is empty, seed initial data
                    seedInitialData();
                }
            };
        }

        // Seed initial data
        function seedInitialData() {
            const transaction = db.transaction(['users', 'brands', 'products', 'settings'], 'readwrite');
            
            // Add admin user
            const usersStore = transaction.objectStore('users');
            usersStore.add({
                name: 'Admin User',
                email: 'admin@customcraft.com',
                password: 'admin123', // In a real app, this would be hashed
                role: 'admin',
                phone: '+1234567890',
                address: '123 Admin St, Admin City',
                createdAt: new Date().toISOString()
            });
            
            // Add some brands
            const brandsStore = transaction.objectStore('brands');
            brandsStore.add({
                name: 'Nike',
                email: 'nike@customcraft.com',
                password: 'nike123',
                description: 'Leading sports footwear and apparel brand',
                logo: 'https://i.imgur.com/1Q9ZQ9r.png',
                categories: ['shoes', 'clothing'],
                bankDetails: {
                    bankName: 'Chase Bank',
                    accountName: 'Nike Inc.',
                    accountNumber: '123456789',
                    routingNumber: '987654321'
                },
                createdAt: new Date().toISOString()
            });
            
            brandsStore.add({
                name: 'Adidas',
                email: 'adidas@customcraft.com',
                password: 'adidas123',
                description: 'German multinational sportswear manufacturer',
                logo: 'https://i.imgur.com/9Q9ZQ9r.png',
                categories: ['shoes', 'bags', 'clothing'],
                bankDetails: {
                    bankName: 'Bank of America',
                    accountName: 'Adidas AG',
                    accountNumber: '987654321',
                    routingNumber: '123456789'
                },
                createdAt: new Date().toISOString()
            });
            
            brandsStore.add({
                name: 'Apple',
                email: 'apple@customcraft.com',
                password: 'apple123',
                description: 'Technology company specializing in consumer electronics',
                logo: 'https://i.imgur.com/2Q9ZQ9r.png',
                categories: ['phones', 'accessories'],
                bankDetails: {
                    bankName: 'Wells Fargo',
                    accountName: 'Apple Inc.',
                    accountNumber: '567891234',
                    routingNumber: '432156789'
                },
                createdAt: new Date().toISOString()
            });
            
            // Add some products
            const productsStore = transaction.objectStore('products');
            productsStore.add({
                brandId: 1, // Nike
                name: 'Air Max Custom',
                category: 'shoes',
                description: 'Customizable Air Max sneakers with personalized colors and materials',
                basePrice: 149.99,
                images: [
                    'https://images.unsplash.com/photo-1600269452121-4f2416e55c28?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60'
                ],
                customizationOptions: 'Colors, materials, logos, text engravings',
                createdAt: new Date().toISOString()
            });
            
            productsStore.add({
                brandId: 2, // Adidas
                name: 'Explorer Backpack',
                category: 'bags',
                description: 'Durable backpack with customizable colors and embroidery',
                basePrice: 79.99,
                images: [
                    'https://images.unsplash.com/photo-1548036328-c9fa89d128fa?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60'
                ],
                customizationOptions: 'Colors, patterns, embroidery, patches',
                createdAt: new Date().toISOString()
            });
            
            productsStore.add({
                brandId: 3, // Apple
                name: 'iPhone Custom Case',
                category: 'phones',
                description: 'Personalized iPhone case with custom designs',
                basePrice: 49.99,
                images: [
                    'https://images.unsplash.com/photo-1510557880182-3d4d3cba35a5?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60'
                ],
                customizationOptions: 'Designs, colors, text, images',
                createdAt: new Date().toISOString()
            });
            
            // Add platform settings
            const settingsStore = transaction.objectStore('settings');
            settingsStore.add({
                id: 'platform',
                name: 'CustomCraft',
                commissionRate: 2.5,
                currency: 'USD',
                logo: '',
                paymentMethods: ['credit', 'debit', 'bank'],
                stripeKey: '',
                paypalKey: '',
                updatedAt: new Date().toISOString()
            });
            
            transaction.oncomplete = function() {
                console.log('Initial data seeded successfully');
            };
            
            transaction.onerror = function(event) {
                console.error('Error seeding initial data:', event.target.error);
            };
        }

        // Check authentication state
        function checkAuthState() {
            const loggedInUser = localStorage.getItem('loggedInUser');
            const loggedInBrand = localStorage.getItem('loggedInBrand');
            const loggedInAdmin = localStorage.getItem('loggedInAdmin');
            
            if (loggedInUser) {
                showUserDashboard(JSON.parse(loggedInUser));
            } else if (loggedInBrand) {
                showBrandDashboard(JSON.parse(loggedInBrand));
            } else if (loggedInAdmin) {
                showAdminDashboard();
            }
        }

        // Setup all event listeners
        function setupEventListeners() {
            // Auth buttons
            document.getElementById('loginBtn').addEventListener('click', () => showModal('loginModal'));
            document.getElementById('registerBtn').addEventListener('click', () => showModal('registerModal'));
            document.getElementById('submitLogin').addEventListener('click', handleLogin);
            document.getElementById('submitRegister').addEventListener('click', handleRegister);
            
            // Modal close buttons
            document.querySelectorAll('.close-modal').forEach(btn => {
                btn.addEventListener('click', function() {
                    const modal = this.closest('.modal');
                    hideModal(modal.id);
                });
            });
            
            // Customization buttons
            document.querySelectorAll('.customize-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const productCard = this.closest('.product-card');
                    const productId = productCard.getAttribute('data-product');
                    showCustomizationModal(productId);
                });
            });
            
            document.getElementById('startDesignBtn').addEventListener('click', () => {
                showCustomizationModal();
            });
            
            document.getElementById('submitCustomization').addEventListener('click', submitCustomizationRequest);
            
            // File uploads
            document.getElementById('designFiles').addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        const preview = document.getElementById('previewImage');
                        preview.src = event.target.result;
                        preview.style.display = 'block';
                    };
                    reader.readAsDataURL(file);
                }
            });
            
            // Dashboard navigation
            document.querySelectorAll('.sidebar-menu a').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const section = this.getAttribute('data-section');
                    showDashboardSection(section);
                    
                    // Update active state
                    document.querySelectorAll('.sidebar-menu a').forEach(a => a.classList.remove('active'));
                    this.classList.add('active');
                });
            });
            
            // Logout buttons
            document.getElementById('logoutBtn').addEventListener('click', logout);
            document.getElementById('brandLogoutBtn').addEventListener('click', logout);
            document.getElementById('adminLogoutBtn').addEventListener('click', logout);
            
            // New request buttons
            document.getElementById('newRequestBtn').addEventListener('click', () => showCustomizationModal());
            document.getElementById('newRequestBtn2').addEventListener('click', () => showCustomizationModal());
            
            // Request detail buttons (will be added dynamically)
            
            // Brand dashboard specific
            document.getElementById('addProductBtn').addEventListener('click', () => showModal('addProductModal'));
            document.getElementById('submitProductBtn').addEventListener('click', addNewProduct);
            
            // Admin dashboard specific
            document.getElementById('addBrandBtn').addEventListener('click', () => showModal('addBrandModal'));
            document.getElementById('submitBrandBtn').addEventListener('click', addNewBrand);
            
            // Form submissions
            document.getElementById('settingsForm').addEventListener('submit', updateUserProfile);
            document.getElementById('passwordForm').addEventListener('submit', changePassword);
            document.getElementById('brandSettingsForm').addEventListener('submit', updateBrandProfile);
            document.getElementById('brandPaymentForm').addEventListener('submit', updateBrandPaymentInfo);
            document.getElementById('adminSettingsForm').addEventListener('submit', updatePlatformSettings);
            document.getElementById('adminPaymentForm').addEventListener('submit', updatePaymentSettings);
            
            // Click outside modal to close
            window.addEventListener('click', function(event) {
                if (event.target.classList.contains('modal')) {
                    hideModal(event.target.id);
                }
            });
        }

        // Show modal
        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        // Hide modal
        function hideModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // Show success notification
        function showSuccess(message) {
            const notification = document.getElementById('successNotification');
            document.getElementById('successMessage').textContent = message;
            notification.style.display = 'flex';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }

        // Show error notification
        function showError(message) {
            const notification = document.getElementById('errorNotification');
            document.getElementById('errorMessage').textContent = message;
            notification.style.display = 'flex';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }

        // Handle login
        function handleLogin() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            if (!email || !password) {
                showError('Please enter both email and password');
                return;
            }
            
            const transaction = db.transaction(['users', 'brands'], 'readonly');
            const usersStore = transaction.objectStore('users');
            const brandsStore = transaction.objectStore('brands');
            
            // Check users first
            const userIndex = usersStore.index('email');
            const userRequest = userIndex.get(email);
            
            userRequest.onsuccess = function() {
                const user = userRequest.result;
                
                if (user && user.password === password) {
                    // Successful login
                    localStorage.setItem('loggedInUser', JSON.stringify(user));
                    
                    if (user.role === 'admin') {
                        localStorage.setItem('loggedInAdmin', 'true');
                        showAdminDashboard();
                    } else {
                        showUserDashboard(user);
                    }
                    
                    hideModal('loginModal');
                    showSuccess('Login successful!');
                } else {
                    // Check brands if no user found
                    const brandIndex = brandsStore.index('email');
                    const brandRequest = brandIndex.get(email);
                    
                    brandRequest.onsuccess = function() {
                        const brand = brandRequest.result;
                        
                        if (brand && brand.password === password) {
                            // Successful brand login
                            localStorage.setItem('loggedInBrand', JSON.stringify(brand));
                            showBrandDashboard(brand);
                            hideModal('loginModal');
                            showSuccess('Login successful!');
                        } else {
                            showError('Invalid email or password');
                        }
                    };
                    
                    brandRequest.onerror = function() {
                        showError('Error checking brand credentials');
                    };
                }
            };
            
            userRequest.onerror = function() {
                showError('Error checking user credentials');
            };
        }

        // Handle registration
        function handleRegister() {
            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const confirm = document.getElementById('registerConfirm').value;
            
            if (!name || !email || !password || !confirm) {
                showError('Please fill in all fields');
                return;
            }
            
            if (password !== confirm) {
                showError('Passwords do not match');
                return;
            }
            
            const transaction = db.transaction(['users'], 'readwrite');
            const usersStore = transaction.objectStore('users');
            
            // Check if email already exists
            const emailIndex = usersStore.index('email');
            const checkRequest = emailIndex.get(email);
            
            checkRequest.onsuccess = function() {
                if (checkRequest.result) {
                    showError('Email already registered');
                } else {
                    // Add new user
                    const addRequest = usersStore.add({
                        name: name,
                        email: email,
                        password: password,
                        role: 'user',
                        phone: '',
                        address: '',
                        createdAt: new Date().toISOString()
                    });
                    
                    addRequest.onsuccess = function() {
                        hideModal('registerModal');
                        showSuccess('Registration successful! Please login.');
                    };
                    
                    addRequest.onerror = function() {
                        showError('Error registering user');
                    };
                }
            };
            
            checkRequest.onerror = function() {
                showError('Error checking email availability');
            };
        }

        // Logout
        function logout() {
            localStorage.removeItem('loggedInUser');
            localStorage.removeItem('loggedInBrand');
            localStorage.removeItem('loggedInAdmin');
            
            document.getElementById('dashboard').style.display = 'none';
            document.getElementById('brandDashboard').style.display = 'none';
            document.getElementById('adminDashboard').style.display = 'none';
            
            document.querySelector('header').style.display = 'block';
            document.querySelectorAll('section, footer').forEach(el => {
                el.style.display = 'block';
            });
            
            showSuccess('Logged out successfully');
        }

        // Show user dashboard
        function showUserDashboard(user) {
            document.getElementById('dashboard').style.display = 'flex';
            document.getElementById('sidebarUsername').textContent = user.name;
            
            // Hide main site content
            document.querySelector('header').style.display = 'none';
            document.querySelectorAll('section, footer').forEach(el => {
                el.style.display = 'none';
            });
            
            // Load user data
            loadUserData(user.id);
        }

        // Show brand dashboard
        function showBrandDashboard(brand) {
            document.getElementById('brandDashboard').style.display = 'flex';
            document.getElementById('brandSidebarName').textContent = brand.name;
            
            // Hide main site content
            document.querySelector('header').style.display = 'none';
            document.querySelectorAll('section, footer').forEach(el => {
                el.style.display = 'none';
            });
            
            // Load brand data
            loadBrandData(brand.id);
        }

        // Show admin dashboard
        function showAdminDashboard() {
            document.getElementById('adminDashboard').style.display = 'flex';
            
            // Hide main site content
            document.querySelector('header').style.display = 'none';
            document.querySelectorAll('section, footer').forEach(el => {
                el.style.display = 'none';
            });
            
            // Load admin data
            loadAdminData();
        }

        // Show dashboard section
        function showDashboardSection(section) {
            // Hide all sections
            document.querySelectorAll('.dashboard-section').forEach(el => {
                el.style.display = 'none';
            });
            
            // Show requested section
            document.getElementById(`${section}-section`).style.display = 'block';
            
            // Load section data if needed
            if (section === 'requests') {
                loadUserRequests();
            } else if (section === 'orders') {
                loadUserOrders();
            } else if (section === 'brand-requests') {
                loadBrandRequests();
            } else if (section === 'brand-orders') {
                loadBrandOrders();
            } else if (section === 'brand-products') {
                loadBrandProducts();
            } else if (section === 'admin-transactions') {
                loadAllTransactions();
            } else if (section === 'admin-brands') {
                loadAllBrands();
            } else if (section === 'admin-users') {
                loadAllUsers();
            }
        }

        // Load user data
        function loadUserData(userId) {
            // Load recent activity
            const activityTransaction = db.transaction(['requests', 'orders'], 'readonly');
            const requestsStore = activityTransaction.objectStore('requests');
            const ordersStore = activityTransaction.objectStore('orders');
            
            const userRequestsIndex = requestsStore.index('userId');
            const userRequestsRequest = userRequestsIndex.getAll(userId);
            
            userRequestsRequest.onsuccess = function() {
                const requests = userRequestsRequest.result;
                const recentActivityTable = document.getElementById('recentActivityTable');
                recentActivityTable.innerHTML = '';
                
                // Sort by date (newest first)
                requests.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
                
                // Show only last 5
                const recentRequests = requests.slice(0, 5);
                
                recentRequests.forEach(request => {
                    const row = document.createElement('tr');
                    
                    // Get product name
                    const productTransaction = db.transaction(['products'], 'readonly');
                    const productsStore = productTransaction.objectStore('products');
                    const productRequest = productsStore.get(request.productId);
                    
                    productRequest.onsuccess = function() {
                        const product = productRequest.result;
                        
                        row.innerHTML = `
                            <td>${formatDate(request.createdAt)}</td>
                            <td>Customization request for ${product ? product.name : 'product'}</td>
                            <td><span class="status-badge status-${request.status}">${request.status}</span></td>
                            <td><button class="action-btn view" data-request-id="${request.id}">View</button></td>
                        `;
                        
                        recentActivityTable.appendChild(row);
                        
                        // Add event listener to view button
                        row.querySelector('.view').addEventListener('click', () => {
                            showRequestDetails(request.id);
                        });
                    };
                });
            };
            
            // Load pending requests
            const pendingRequestsIndex = requestsStore.index('userId');
            const pendingStatusIndex = requestsStore.index('status');
            
            // We need to get all user requests and then filter by status
            const allUserRequestsRequest = userRequestsIndex.getAll(userId);
            
            allUserRequestsRequest.onsuccess = function() {
                const allRequests = allUserRequestsRequest.result;
                const pendingRequests = allRequests.filter(req => req.status === 'pending' || req.status === 'approved');
                
                const pendingRequestsTable = document.getElementById('pendingRequestsTable');
                pendingRequestsTable.innerHTML = '';
                
                pendingRequests.forEach(request => {
                    const row = document.createElement('tr');
                    
                    // Get product and brand info
                    const productTransaction = db.transaction(['products', 'brands'], 'readonly');
                    const productsStore = productTransaction.objectStore('products');
                    const brandsStore = productTransaction.objectStore('brands');
                    
                    const productRequest = productsStore.get(request.productId);
                    const brandRequest = brandsStore.get(request.brandId);
                    
                    Promise.all([productRequest, brandRequest].map(req => {
                        return new Promise(resolve => {
                            req.onsuccess = () => resolve(req.result);
                        });
                    })).then(([product, brand]) => {
                        row.innerHTML = `
                            <td>REQ-${request.id.toString().padStart(5, '0')}</td>
                            <td>${product ? product.name : 'Unknown Product'}</td>
                            <td>${brand ? brand.name : 'Unknown Brand'}</td>
                            <td>${formatDate(request.createdAt)}</td>
                            <td><span class="status-badge status-${request.status}">${request.status}</span></td>
                            <td><button class="action-btn view" data-request-id="${request.id}">View</button></td>
                        `;
                        
                        pendingRequestsTable.appendChild(row);
                        
                        // Add event listener to view button
                        row.querySelector('.view').addEventListener('click', () => {
                            showRequestDetails(request.id);
                        });
                    });
                });
            };
        }

        // Load user requests
        function loadUserRequests() {
            const loggedInUser = JSON.parse(localStorage.getItem('loggedInUser'));
            if (!loggedInUser) return;
            
            const transaction = db.transaction(['requests', 'products', 'brands'], 'readonly');
            const requestsStore = transaction.objectStore('requests');
            const productsStore = transaction.objectStore('products');
            const brandsStore = transaction.objectStore('brands');
            
            const userRequestsIndex = requestsStore.index('userId');
            const userRequestsRequest = userRequestsIndex.getAll(loggedInUser.id);
            
            userRequestsRequest.onsuccess = function() {
                const requests = userRequestsRequest.result;
                const allRequestsTable = document.getElementById('allRequestsTable');
                allRequestsTable.innerHTML = '';
                
                requests.forEach(request => {
                    const row = document.createElement('tr');
                    
                    const productRequest = productsStore.get(request.productId);
                    const brandRequest = brandsStore.get(request.brandId);
                    
                    Promise.all([productRequest, brandRequest].map(req => {
                        return new Promise(resolve => {
                            req.onsuccess = () => resolve(req.result);
                        });
                    })).then(([product, brand]) => {
                        row.innerHTML = `
                            <td>REQ-${request.id.toString().padStart(5, '0')}</td>
                            <td>${product ? product.name : 'Unknown Product'}</td>
                            <td>${brand ? brand.name : 'Unknown Brand'}</td>
                            <td>${formatDate(request.createdAt)}</td>
                            <td><span class="status-badge status-${request.status}">${request.status}</span></td>
                            <td>${request.quote ? '$' + request.quote.toFixed(2) : 'Pending'}</td>
                            <td>
                                <button class="action-btn view" data-request-id="${request.id}">View</button>
                                ${request.status === 'approved' ? '<button class="action-btn edit" data-request-id="' + request.id + '">Pay</button>' : ''}
                            </td>
                        `;
                        
                        allRequestsTable.appendChild(row);
                        
                        // Add event listeners to buttons
                        row.querySelector('.view').addEventListener('click', () => {
                            showRequestDetails(request.id);
                        });
                        
                        const payBtn = row.querySelector('.edit');
                        if (payBtn) {
                            payBtn.addEventListener('click', () => {
                                initiatePayment(request.id);
                            });
                        }
                    });
                });
            };
        }

        // Load user orders
        function loadUserOrders() {
            const loggedInUser = JSON.parse(localStorage.getItem('loggedInUser'));
            if (!loggedInUser) return;
            
            const transaction = db.transaction(['orders', 'requests', 'products', 'brands'], 'readonly');
            const ordersStore = transaction.objectStore('orders');
            const requestsStore = transaction.objectStore('requests');
            const productsStore = transaction.objectStore('products');
            const brandsStore = transaction.objectStore('brands');
            
            const userOrdersIndex = ordersStore.index('userId');
            const userOrdersRequest = userOrdersIndex.getAll(loggedInUser.id);
            
            userOrdersRequest.onsuccess = function() {
                const orders = userOrdersRequest.result;
                const ordersTable = document.getElementById('ordersTable');
                ordersTable.innerHTML = '';
                
                orders.forEach(order => {
                    const row = document.createElement('tr');
                    
                    const requestRequest = requestsStore.get(order.requestId);
                    const productRequest = productsStore.get(order.productId);
                    const brandRequest = brandsStore.get(order.brandId);
                    
                    Promise.all([requestRequest, productRequest, brandRequest].map(req => {
                        return new Promise(resolve => {
                            req.onsuccess = () => resolve(req.result);
                        });
                    })).then(([request, product, brand]) => {
                        row.innerHTML = `
                            <td>ORD-${order.id.toString().padStart(5, '0')}</td>
                            <td>${product ? product.name : 'Unknown Product'}</td>
                            <td>${brand ? brand.name : 'Unknown Brand'}</td>
                            <td>${formatDate(order.createdAt)}</td>
                            <td>$${order.amount.toFixed(2)}</td>
                            <td><span class="status-badge status-${order.status}">${order.status}</span></td>
                            <td>${order.trackingNumber || 'N/A'}</td>
                        `;
                        
                        ordersTable.appendChild(row);
                    });
                });
            };
        }

        // Load brand data
        function loadBrandData(brandId) {
            // Load statistics
            const statsTransaction = db.transaction(['requests', 'orders', 'transactions'], 'readonly');
            const requestsStore = statsTransaction.objectStore('requests');
            const ordersStore = statsTransaction.objectStore('orders');
            const transactionsStore = statsTransaction.objectStore('transactions');
            
            // Pending requests count
            const brandRequestsIndex = requestsStore.index('brandId');
            const pendingStatusIndex = requestsStore.index('status');
            
            // Get all brand requests and filter
            const allBrandRequestsRequest = brandRequestsIndex.getAll(brandId);
            
            allBrandRequestsRequest.onsuccess = function() {
                const allRequests = allBrandRequestsRequest.result;
                
                // Pending requests
                const pendingRequests = allRequests.filter(req => req.status === 'pending');
                document.getElementById('pendingRequestsCount').textContent = pendingRequests.length;
                
                // Completed orders (we need to check orders table)
                const brandOrdersIndex = ordersStore.index('brandId');
                const completedStatusIndex = ordersStore.index('status');
                
                // Get all brand orders and filter completed
                const allBrandOrdersRequest = brandOrdersIndex.getAll(brandId);
                
                allBrandOrdersRequest.onsuccess = function() {
                    const allOrders = allBrandOrdersRequest.result;
                    const completedOrders = allOrders.filter(order => order.status === 'completed');
                    document.getElementById('completedOrdersCount').textContent = completedOrders.length;
                    
                    // Calculate total revenue and commission
                    const orderIds = allOrders.map(order => order.id);
                    let totalRevenue = 0;
                    let totalCommission = 0;
                    
                    // We need to get transactions for these orders
                    if (orderIds.length > 0) {
                        const transactionRequests = orderIds.map(orderId => {
                            return new Promise(resolve => {
                                const transactionIndex = transactionsStore.index('orderId');
                                const transactionRequest = transactionIndex.get(orderId);
                                
                                transactionRequest.onsuccess = function() {
                                    const transaction = transactionRequest.result;
                                    if (transaction) {
                                        totalRevenue += transaction.amount;
                                        totalCommission += transaction.commission;
                                    }
                                    resolve();
                                };
                            });
                        });
                        
                        Promise.all(transactionRequests).then(() => {
                            document.getElementById('totalRevenueCount').textContent = '$' + totalRevenue.toFixed(2);
                            document.getElementById('platformCommissionCount').textContent = '$' + totalCommission.toFixed(2);
                        });
                    } else {
                        document.getElementById('totalRevenueCount').textContent = '$0';
                        document.getElementById('platformCommissionCount').textContent = '$0';
                    }
                };
            };
            
            // Load recent requests
            const recentRequestsRequest = brandRequestsIndex.getAll(brandId);
            
            recentRequestsRequest.onsuccess = function() {
                const requests = recentRequestsRequest.result;
                const recentRequestsTable = document.getElementById('brandRecentRequestsTable');
                recentRequestsTable.innerHTML = '';
                
                // Sort by date (newest first)
                requests.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
                
                // Show only last 5
                const recentRequests = requests.slice(0, 5);
                
                recentRequests.forEach(request => {
                    const row = document.createElement('tr');
                    
                    // Get product and user info
                    const productTransaction = db.transaction(['products', 'users'], 'readonly');
                    const productsStore = productTransaction.objectStore('products');
                    const usersStore = productTransaction.objectStore('users');
                    
                    const productRequest = productsStore.get(request.productId);
                    const userRequest = usersStore.get(request.userId);
                    
                    Promise.all([productRequest, userRequest].map(req => {
                        return new Promise(resolve => {
                            req.onsuccess = () => resolve(req.result);
                        });
                    })).then(([product, user]) => {
                        row.innerHTML = `
                            <td>REQ-${request.id.toString().padStart(5, '0')}</td>
                            <td>${product ? product.name : 'Unknown Product'}</td>
                            <td>${user ? user.name : 'Unknown User'}</td>
                            <td>${formatDate(request.createdAt)}</td>
                            <td><span class="status-badge status-${request.status}">${request.status}</span></td>
                            <td><button class="action-btn view" data-request-id="${request.id}">View</button></td>
                        `;
                        
                        recentRequestsTable.appendChild(row);
                        
                        // Add event listener to view button
                        row.querySelector('.view').addEventListener('click', () => {
                            showBrandRequestDetails(request.id);
                        });
                    });
                });
            };
            
            // Load brand info for settings
            const brandTransaction = db.transaction(['brands'], 'readonly');
            const brandsStore = brandTransaction.objectStore('brands');
            const brandRequest = brandsStore.get(brandId);
            
            brandRequest.onsuccess = function() {
                const brand = brandRequest.result;
                
                // Populate settings form
                document.getElementById('brandName').value = brand.name;
                document.getElementById('brandDescription').value = brand.description;
                
                // Logo preview if exists
                if (brand.logo) {
                    document.getElementById('brandLogoPreview').src = brand.logo;
                    document.getElementById('brandLogoPreview').style.display = 'block';
                }
                
                // Categories
                if (brand.categories && brand.categories.length > 0) {
                    const categorySelect = document.getElementById('brandCategories');
                    Array.from(categorySelect.options).forEach(option => {
                        if (brand.categories.includes(option.value)) {
                            option.selected = true;
                        }
                    });
                }
                
                // Payment info
                if (brand.bankDetails) {
                    document.getElementById('bankName').value = brand.bankDetails.bankName || '';
                    document.getElementById('accountName').value = brand.bankDetails.accountName || '';
                    document.getElementById('accountNumber').value = brand.bankDetails.accountNumber || '';
                    document.getElementById('routingNumber').value = brand.bankDetails.routingNumber || '';
                }
            };
        }

        // Load brand requests
        function loadBrandRequests() {
            const loggedInBrand = JSON.parse(localStorage.getItem('loggedInBrand'));
            if (!loggedInBrand) return;
            
            const transaction = db.transaction(['requests', 'products', 'users'], 'readonly');
            const requestsStore = transaction.objectStore('requests');
            const productsStore = transaction.objectStore('products');
            const usersStore = transaction.objectStore('users');
            
            const brandRequestsIndex = requestsStore.index('brandId');
            const brandRequestsRequest = brandRequestsIndex.getAll(loggedInBrand.id);
            
            brandRequestsRequest.onsuccess = function() {
                const requests = brandRequestsRequest.result;
                const allRequestsTable = document.getElementById('brandAllRequestsTable');
                allRequestsTable.innerHTML = '';
                
                requests.forEach(request => {
                    const row = document.createElement('tr');
                    
                    const productRequest = productsStore.get(request.productId);
                    const userRequest = usersStore.get(request.userId);
                    
                    Promise.all([productRequest, userRequest].map(req => {
                        return new Promise(resolve => {
                            req.onsuccess = () => resolve(req.result);
                        });
                    })).then(([product, user]) => {
                        row.innerHTML = `
                            <td>REQ-${request.id.toString().padStart(5, '0')}</td>
                            <td>${product ? product.name : 'Unknown Product'}</td>
                            <td>${user ? user.name : 'Unknown User'}</td>
                            <td>${formatDate(request.createdAt)}</td>
                            <td><span class="status-badge status-${request.status}">${request.status}</span></td>
                            <td><button class="action-btn view" data-request-id="${request.id}">View</button></td>
                        `;
                        
                        allRequestsTable.appendChild(row);
                        
                        // Add event listener to view button
                        row.querySelector('.view').addEventListener('click', () => {
                            showBrandRequestDetails(request.id);
                        });
                    });
                });
            };
        }

        // Load brand orders
        function loadBrandOrders() {
            const loggedInBrand = JSON.parse(localStorage.getItem('loggedInBrand'));
            if (!loggedInBrand) return;
            
            const transaction = db.transaction(['orders', 'requests', 'products', 'users'], 'readonly');
            const ordersStore = transaction.objectStore('orders');
            const requestsStore = transaction.objectStore('requests');
            const productsStore = transaction.objectStore('products');
            const usersStore = transaction.objectStore('users');
            
            const brandOrdersIndex = ordersStore.index('brandId');
            const brandOrdersRequest = brandOrdersIndex.getAll(loggedInBrand.id);
            
            brandOrdersRequest.onsuccess = function() {
                const orders = brandOrdersRequest.result;
                const ordersTable = document.getElementById('brandOrdersTable');
                ordersTable.innerHTML = '';
                
                orders.forEach(order => {
                    const row = document.createElement('tr');
                    
                    const requestRequest = requestsStore.get(order.requestId);
                    const productRequest = productsStore.get(order.productId);
                    const userRequest = usersStore.get(order.userId);
                    
                    Promise.all([requestRequest, productRequest, userRequest].map(req => {
                        return new Promise(resolve => {
                            req.onsuccess = () => resolve(req.result);
                        });
                    })).then(([request, product, user]) => {
                        row.innerHTML = `
                            <td>ORD-${order.id.toString().padStart(5, '0')}</td>
                            <td>${product ? product.name : 'Unknown Product'}</td>
                            <td>${user ? user.name : 'Unknown User'}</td>
                            <td>${formatDate(order.createdAt)}</td>
                            <td>$${order.amount.toFixed(2)}</td>
                            <td><span class="status-badge status-${order.status}">${order.status}</span></td>
                            <td>
                                <button class="action-btn view" data-order-id="${order.id}">View</button>
                                ${order.status === 'paid' ? '<button class="action-btn edit" data-order-id="' + order.id + '">Fulfill</button>' : ''}
                            </td>
                        `;
                        
                        ordersTable.appendChild(row);
                        
                        // Add event listeners to buttons
                        row.querySelector('.view').addEventListener('click', () => {
                            // TODO: Show order details
                        });
                        
                        const fulfillBtn = row.querySelector('.edit');
                        if (fulfillBtn) {
                            fulfillBtn.addEventListener('click', () => {
                                fulfillOrder(order.id);
                            });
                        }
                    });
                });
            };
        }

        // Load brand products
        function loadBrandProducts() {
            const loggedInBrand = JSON.parse(localStorage.getItem('loggedInBrand'));
            if (!loggedInBrand) return;
            
            const transaction = db.transaction(['products'], 'readonly');
            const productsStore = transaction.objectStore('products');
            
            const brandProductsIndex = productsStore.index('brandId');
            const brandProductsRequest = brandProductsIndex.getAll(loggedInBrand.id);
            
            brandProductsRequest.onsuccess = function() {
                const products = brandProductsRequest.result;
                const productsTable = document.getElementById('brandProductsTable');
                productsTable.innerHTML = '';
                
                products.forEach(product => {
                    const row = document.createElement('tr');
                    
                    row.innerHTML = `
                        <td>PROD-${product.id.toString().padStart(5, '0')}</td>
                        <td>${product.name}</td>
                        <td>${product.category}</td>
                        <td>$${product.basePrice.toFixed(2)}</td>
                        <td><span class="status-badge status-completed">Active</span></td>
                        <td>
                            <button class="action-btn view" data-product-id="${product.id}">View</button>
                            <button class="action-btn edit" data-product-id="${product.id}">Edit</button>
                            <button class="action-btn delete" data-product-id="${product.id}">Delete</button>
                        </td>
                    `;
                    
                    productsTable.appendChild(row);
                    
                    // Add event listeners to buttons
                    row.querySelector('.view').addEventListener('click', () => {
                        // TODO: Show product details
                    });
                    
                    row.querySelector('.edit').addEventListener('click', () => {
                        // TODO: Edit product
                    });
                    
                    row.querySelector('.delete').addEventListener('click', () => {
                        if (confirm('Are you sure you want to delete this product?')) {
                            deleteProduct(product.id);
                        }
                    });
                });
            };
        }

        // Load admin data
        function loadAdminData() {
            // Load statistics
            const statsTransaction = db.transaction(['transactions', 'brands', 'users'], 'readonly');
            const transactionsStore = statsTransaction.objectStore('transactions');
            const brandsStore = statsTransaction.objectStore('brands');
            const usersStore = statsTransaction.objectStore('users');
            
            // Total transactions
            const transactionsCountRequest = transactionsStore.count();
            
            transactionsCountRequest.onsuccess = function() {
                document.getElementById('totalTransactionsCount').textContent = transactionsCountRequest.result;
            };
            
            // Total commission
            const transactionsRequest = transactionsStore.getAll();
            
            transactionsRequest.onsuccess = function() {
                const transactions = transactionsRequest.result;
                const totalCommission = transactions.reduce((sum, transaction) => sum + transaction.commission, 0);
                document.getElementById('totalCommissionCount').textContent = '$' + totalCommission.toFixed(2);
            };
            
            // Total brands
            const brandsCountRequest = brandsStore.count();
            
            brandsCountRequest.onsuccess = function() {
                document.getElementById('totalBrandsCount').textContent = brandsCountRequest.result;
            };
            
            // Total users
            const usersCountRequest = usersStore.count();
            
            usersCountRequest.onsuccess = function() {
                document.getElementById('totalUsersCount').textContent = usersCountRequest.result;
            };
            
            // Recent transactions
            const recentTransactionsRequest = transactionsStore.getAll();
            
            recentTransactionsRequest.onsuccess = function() {
                const transactions = recentTransactionsRequest.result;
                const recentTransactionsTable = document.getElementById('adminRecentTransactionsTable');
                recentTransactionsTable.innerHTML = '';
                
                // Sort by date (newest first)
                transactions.sort((a, b) => new Date(b.date) - new Date(a.date));
                
                // Show only last 5
                const recentTransactions = transactions.slice(0, 5);
                
                recentTransactions.forEach(transaction => {
                    const row = document.createElement('tr');
                    
                    // Get order, user and brand info
                    const orderTransaction = db.transaction(['orders', 'users', 'brands'], 'readonly');
                    const ordersStore = orderTransaction.objectStore('orders');
                    const usersStore = orderTransaction.objectStore('users');
                    const brandsStore = orderTransaction.objectStore('brands');
                    
                    const orderRequest = ordersStore.get(transaction.orderId);
                    const userRequest = usersStore.get(transaction.userId);
                    const brandRequest = brandsStore.get(transaction.brandId);
                    
                    Promise.all([orderRequest, userRequest, brandRequest].map(req => {
                        return new Promise(resolve => {
                            req.onsuccess = () => resolve(req.result);
                        });
                    })).then(([order, user, brand]) => {
                        row.innerHTML = `
                            <td>TXN-${transaction.id.toString().padStart(5, '0')}</td>
                            <td>ORD-${order ? order.id.toString().padStart(5, '0') : 'N/A'}</td>
                            <td>${user ? user.name : 'Unknown User'}</td>
                            <td>${brand ? brand.name : 'Unknown Brand'}</td>
                            <td>$${transaction.amount.toFixed(2)}</td>
                            <td>$${transaction.commission.toFixed(2)}</td>
                            <td>${formatDate(transaction.date)}</td>
                        `;
                        
                        recentTransactionsTable.appendChild(row);
                    });
                });
            };
            
            // Load platform settings
            const settingsTransaction = db.transaction(['settings'], 'readonly');
            const settingsStore = settingsTransaction.objectStore('settings');
            const settingsRequest = settingsStore.get('platform');
            
            settingsRequest.onsuccess = function() {
                const settings = settingsRequest.result;
                if (settings) {
                    document.getElementById('platformName').value = settings.name;
                    document.getElementById('platformCommission').value = settings.commissionRate;
                    document.getElementById('platformCurrency').value = settings.currency;
                    
                    if (settings.logo) {
                        document.getElementById('platformLogoPreview').src = settings.logo;
                        document.getElementById('platformLogoPreview').style.display = 'block';
                    }
                    
                    if (settings.paymentMethods) {
                        document.querySelectorAll('input[name="paymentMethods"]').forEach(checkbox => {
                            checkbox.checked = settings.paymentMethods.includes(checkbox.value);
                        });
                    }
                    
                    document.getElementById('stripeKey').value = settings.stripeKey || '';
                    document.getElementById('paypalKey').value = settings.paypalKey || '';
                }
            };
        }

        // Load all transactions
        function loadAllTransactions() {
            const transaction = db.transaction(['transactions', 'orders', 'users', 'brands'], 'readonly');
            const transactionsStore = transaction.objectStore('transactions');
            const ordersStore = transaction.objectStore('orders');
            const usersStore = transaction.objectStore('users');
            const brandsStore = transaction.objectStore('brands');
            
            const transactionsRequest = transactionsStore.getAll();
            
            transactionsRequest.onsuccess = function() {
                const transactions = transactionsRequest.result;
                const transactionsTable = document.getElementById('adminAllTransactionsTable');
                transactionsTable.innerHTML = '';
                
                // Sort by date (newest first)
                transactions.sort((a, b) => new Date(b.date) - new Date(a.date));
                
                transactions.forEach(transaction => {
                    const row = document.createElement('tr');
                    
                    const orderRequest = ordersStore.get(transaction.orderId);
                    const userRequest = usersStore.get(transaction.userId);
                    const brandRequest = brandsStore.get(transaction.brandId);
                    
                    Promise.all([orderRequest, userRequest, brandRequest].map(req => {
                        return new Promise(resolve => {
                            req.onsuccess = () => resolve(req.result);
                        });
                    })).then(([order, user, brand]) => {
                        row.innerHTML = `
                            <td>TXN-${transaction.id.toString().padStart(5, '0')}</td>
                            <td>ORD-${order ? order.id.toString().padStart(5, '0') : 'N/A'}</td>
                            <td>${user ? user.name : 'Unknown User'}</td>
                            <td>${brand ? brand.name : 'Unknown Brand'}</td>
                            <td>$${transaction.amount.toFixed(2)}</td>
                            <td>$${transaction.commission.toFixed(2)}</td>
                            <td>${formatDate(transaction.date)}</td>
                            <td><span class="status-badge status-completed">Completed</span></td>
                        `;
                        
                        transactionsTable.appendChild(row);
                    });
                });
            };
        }

        // Load all brands
        function loadAllBrands() {
            const transaction = db.transaction(['brands', 'products', 'orders'], 'readonly');
            const brandsStore = transaction.objectStore('brands');
            const productsStore = transaction.objectStore('products');
            const ordersStore = transaction.objectStore('orders');
            
            const brandsRequest = brandsStore.getAll();
            
            brandsRequest.onsuccess = function() {
                const brands = brandsRequest.result;
                const brandsTable = document.getElementById('adminBrandsTable');
                brandsTable.innerHTML = '';
                
                brands.forEach(brand => {
                    const row = document.createElement('tr');
                    
                    // Count products for this brand
                    const brandProductsIndex = productsStore.index('brandId');
                    const productsCountRequest = brandProductsIndex.count(brand.id);
                    
                    // Count orders for this brand
                    const brandOrdersIndex = ordersStore.index('brandId');
                    const ordersCountRequest = brandOrdersIndex.count(brand.id);
                    
                    Promise.all([
                        new Promise(resolve => {
                            productsCountRequest.onsuccess = () => resolve(productsCountRequest.result);
                        }),
                        new Promise(resolve => {
                            ordersCountRequest.onsuccess = () => resolve(ordersCountRequest.result);
                        })
                    ]).then(([productsCount, ordersCount]) => {
                        row.innerHTML = `
                            <td>BR-${brand.id.toString().padStart(5, '0')}</td>
                            <td>${brand.name}</td>
                            <td>${brand.categories ? brand.categories.join(', ') : ''}</td>
                            <td>${productsCount}</td>
                            <td>${ordersCount}</td>
                            <td>${formatDate(brand.createdAt)}</td>
                            <td><span class="status-badge status-completed">Active</span></td>
                            <td>
                                <button class="action-btn view" data-brand-id="${brand.id}">View</button>
                                <button class="action-btn edit" data-brand-id="${brand.id}">Edit</button>
                            </td>
                        `;
                        
                        brandsTable.appendChild(row);
                        
                        // Add event listeners to buttons
                        row.querySelector('.view').addEventListener('click', () => {
                            showBrandDetails(brand.id);
                        });
                        
                        row.querySelector('.edit').addEventListener('click', () => {
                            // TODO: Edit brand
                        });
                    });
                });
            };
        }

        // Load all users
        function loadAllUsers() {
            const transaction = db.transaction(['users', 'requests', 'orders'], 'readonly');
            const usersStore = transaction.objectStore('users');
            const requestsStore = transaction.objectStore('requests');
            const ordersStore = transaction.objectStore('orders');
            
            const usersRequest = usersStore.getAll();
            
            usersRequest.onsuccess = function() {
                const users = usersRequest.result;
                const usersTable = document.getElementById('adminUsersTable');
                usersTable.innerHTML = '';
                
                // Filter out admin users
                const regularUsers = users.filter(user => user.role !== 'admin');
                
                regularUsers.forEach(user => {
                    const row = document.createElement('tr');
                    
                    // Count requests for this user
                    const userRequestsIndex = requestsStore.index('userId');
                    const requestsCountRequest = userRequestsIndex.count(user.id);
                    
                    // Count orders for this user
                    const userOrdersIndex = ordersStore.index('userId');
                    const ordersCountRequest = userOrdersIndex.count(user.id);
                    
                    Promise.all([
                        new Promise(resolve => {
                            requestsCountRequest.onsuccess = () => resolve(requestsCountRequest.result);
                        }),
                        new Promise(resolve => {
                            ordersCountRequest.onsuccess = () => resolve(ordersCountRequest.result);
                        })
                    ]).then(([requestsCount, ordersCount]) => {
                        row.innerHTML = `
                            <td>USR-${user.id.toString().padStart(5, '0')}</td>
                            <td>${user.name}</td>
                            <td>${user.email}</td>
                            <td>${requestsCount}</td>
                            <td>${ordersCount}</td>
                            <td>${formatDate(user.createdAt)}</td>
                            <td><span class="status-badge status-completed">Active</span></td>
                            <td>
                                <button class="action-btn view" data-user-id="${user.id}">View</button>
                                <button class="action-btn edit" data-user-id="${user.id}">Edit</button>
                            </td>
                        `;
                        
                        usersTable.appendChild(row);
                        
                        // Add event listeners to buttons
                        row.querySelector('.view').addEventListener('click', () => {
                            showUserDetails(user.id);
                        });
                        
                        row.querySelector('.edit').addEventListener('click', () => {
                            // TODO: Edit user
                        });
                    });
                });
            };
        }

        // Show customization modal
        function showCustomizationModal(productId) {
            if (productId) {
                // Get product details
                const transaction = db.transaction(['products', 'brands'], 'readonly');
                const productsStore = transaction.objectStore('products');
                const brandsStore = transaction.objectStore('brands');
                
                const productRequest = productsStore.get(parseInt(productId));
                
                productRequest.onsuccess = function() {
                    const product = productRequest.result;
                    if (product) {
                        const brandRequest = brandsStore.get(product.brandId);
                        
                        brandRequest.onsuccess = function() {
                            const brand = brandRequest.result;
                            
                            document.getElementById('customProductName').value = product.name;
                            document.getElementById('customBrandName').value = brand ? brand.name : 'Unknown Brand';
                            
                            // Store product and brand IDs in the form for later use
                            document.getElementById('customizeForm').setAttribute('data-product-id', product.id);
                            document.getElementById('customizeForm').setAttribute('data-brand-id', product.brandId);
                            
                            showModal('customizeModal');
                        };
                    }
                };
            } else {
                // Blank customization form
                document.getElementById('customProductName').value = '';
                document.getElementById('customBrandName').value = '';
                document.getElementById('customDescription').value = '';
                document.getElementById('customNotes').value = '';
                document.getElementById('previewImage').style.display = 'none';
                document.getElementById('designFiles').value = '';
                
                // Remove any stored IDs
                document.getElementById('customizeForm').removeAttribute('data-product-id');
                document.getElementById('customizeForm').removeAttribute('data-brand-id');
                
                showModal('customizeModal');
            }
        }

        // Submit customization request
        function submitCustomizationRequest() {
            const loggedInUser = JSON.parse(localStorage.getItem('loggedInUser'));
            if (!loggedInUser) {
                showError('Please login to submit a customization request');
                return;
            }
            
            const productId = document.getElementById('customizeForm').getAttribute('data-product-id');
            const brandId = document.getElementById('customizeForm').getAttribute('data-brand-id');
            const description = document.getElementById('customDescription').value;
            const notes = document.getElementById('customNotes').value;
            const designFile = document.getElementById('designFiles').files[0];
            
            if (!description) {
                showError('Please provide customization details');
                return;
            }
            
            // If no product selected (custom product), brand must be selected
            if (!productId && !brandId) {
                showError('Please select a brand for your custom product');
                return;
            }
            
            const transaction = db.transaction(['requests'], 'readwrite');
            const requestsStore = transaction.objectStore('requests');
            
            // Convert file to base64 if exists
            let designFileBase64 = null;
            if (designFile) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    designFileBase64 = event.target.result.split(',')[1];
                    
                    // Now that we have the file, add the request
                    addRequest();
                };
                reader.readAsDataURL(designFile);
            } else {
                // No file, just add the request
                addRequest();
            }
            
            function addRequest() {
                const request = {
                    userId: loggedInUser.id,
                    brandId: parseInt(brandId),
                    productId: productId ? parseInt(productId) : null,
                    description: description,
                    notes: notes,
                    designFile: designFileBase64,
                    status: 'pending',
                    response: '',
                    quote: null,
                    createdAt: new Date().toISOString()
                };
                
                const addRequest = requestsStore.add(request);
                
                addRequest.onsuccess = function() {
                    hideModal('customizeModal');
                    showSuccess('Customization request submitted successfully!');
                    
                    // Refresh requests in dashboard
                    loadUserData(loggedInUser.id);
                };
                
                addRequest.onerror = function() {
                    showError('Error submitting customization request');
                };
            }
        }

        // Show request details
        function showRequestDetails(requestId) {
            const transaction = db.transaction(['requests', 'products', 'brands'], 'readonly');
            const requestsStore = transaction.objectStore('requests');
            const productsStore = transaction.objectStore('products');
            const brandsStore = transaction.objectStore('brands');
            
            const requestRequest = requestsStore.get(parseInt(requestId));
            
            requestRequest.onsuccess = function() {
                const request = requestRequest.result;
                if (request) {
                    const productRequest = productsStore.get(request.productId);
                    const brandRequest = brandsStore.get(request.brandId);
                    
                    Promise.all([productRequest, brandRequest].map(req => {
                        return new Promise(resolve => {
                            req.onsuccess = () => resolve(req.result);
                        });
                    })).then(([product, brand]) => {
                        document.getElementById('detailRequestId').value = 'REQ-' + request.id.toString().padStart(5, '0');
                        document.getElementById('detailProduct').value = product ? product.name : 'Custom Product';
                        document.getElementById('detailBrand').value = brand ? brand.name : 'Unknown Brand';
                        document.getElementById('detailStatus').value = request.status.charAt(0).toUpperCase() + request.status.slice(1);
                        document.getElementById('detailSubmitted').value = formatDate(request.createdAt);
                        document.getElementById('detailDescription').value = request.description;
                        document.getElementById('detailResponse').value = request.response || 'No response yet';
                        document.getElementById('detailQuote').value = request.quote ? '$' + request.quote.toFixed(2) : 'Not quoted yet';
                        
                        // Show payment section if request is approved and not paid yet
                        const paymentSection = document.getElementById('paymentSection');
                        if (request.status === 'approved') {
                            // Check if order exists for this request
                            const orderTransaction = db.transaction(['orders'], 'readonly');
                            const ordersStore = orderTransaction.objectStore('orders');
                            const requestIndex = ordersStore.index('requestId');
                            const orderRequest = requestIndex.get(request.id);
                            
                            orderRequest.onsuccess = function() {
                                if (!orderRequest.result) {
                                    paymentSection.style.display = 'block';
                                } else {
                                    paymentSection.style.display = 'none';
                                }
                            };
                        } else {
                            paymentSection.style.display = 'none';
                        }
                        
                        showModal('requestDetailModal');
                    });
                }
            };
        }

        // Show brand request details
        function showBrandRequestDetails(requestId) {
            const transaction = db.transaction(['requests', 'products', 'users'], 'readonly');
            const requestsStore = transaction.objectStore('requests');
            const productsStore = transaction.objectStore('products');
            const usersStore = transaction.objectStore('users');
            
            const requestRequest = requestsStore.get(parseInt(requestId));
            
            requestRequest.onsuccess = function() {
                const request = requestRequest.result;
                if (request) {
                    const productRequest = productsStore.get(request.productId);
                    const userRequest = usersStore.get(request.userId);
                    
                    Promise.all([productRequest, userRequest].map(req => {
                        return new Promise(resolve => {
                            req.onsuccess = () => resolve(req.result);
                        });
                    })).then(([product, user]) => {
                        document.getElementById('brandDetailRequestId').value = 'REQ-' + request.id.toString().padStart(5, '0');
                        document.getElementById('brandDetailProduct').value = product ? product.name : 'Custom Product';
                        document.getElementById('brandDetailCustomer').value = user ? user.name : 'Unknown User';
                        document.getElementById('brandDetailSubmitted').value = formatDate(request.createdAt);
                        document.getElementById('brandDetailStatus').value = request.status;
                        document.getElementById('brandDetailDescription').value = request.description;
                        document.getElementById('brandDetailResponse').value = request.response || '';
                        document.getElementById('brandDetailQuote').value = request.quote || '';
                        
                        // Show design files if exists
                        const designFilesDiv = document.getElementById('brandDesignFiles');
                        if (request.designFile) {
                            designFilesDiv.innerHTML = `
                                <a href="data:image/png;base64,${request.designFile}" download="design-${request.id}.png" style="color: var(--primary); text-decoration: none;">
                                    <i class="fas fa-download"></i> Download Design File
                                </a>
                            `;
                        } else {
                            designFilesDiv.textContent = 'No files uploaded';
                        }
                        
                        showModal('brandRequestDetailModal');
                        
                        // Store request ID for saving
                        document.getElementById('saveBrandRequestBtn').setAttribute('data-request-id', request.id);
                    });
                }
            };
        }

        // Save brand request changes
        document.getElementById('saveBrandRequestBtn').addEventListener('click', function() {
            const requestId = this.getAttribute('data-request-id');
            if (!requestId) return;
            
            const status = document.getElementById('brandDetailStatus').value;
            const response = document.getElementById('brandDetailResponse').value;
            const quote = parseFloat(document.getElementById('brandDetailQuote').value);
            
            if (status === 'approved' && (isNaN(quote) || quote <= 0)) {
                showError('Please enter a valid quote amount for approved requests');
                return;
            }
            
            const transaction = db.transaction(['requests'], 'readwrite');
            const requestsStore = transaction.objectStore('requests');
            
            const getRequest = requestsStore.get(parseInt(requestId));
            
            getRequest.onsuccess = function() {
                const request = getRequest.result;
                if (request) {
                    // Update request
                    request.status = status;
                    request.response = response;
                    request.quote = !isNaN(quote) ? quote : null;
                    
                    const updateRequest = requestsStore.put(request);
                    
                    updateRequest.onsuccess = function() {
                        hideModal('brandRequestDetailModal');
                        showSuccess('Request updated successfully!');
                        
                        // Refresh brand dashboard
                        const loggedInBrand = JSON.parse(localStorage.getItem('loggedInBrand'));
                        if (loggedInBrand) {
                            loadBrandData(loggedInBrand.id);
                        }
                    };
                    
                    updateRequest.onerror = function() {
                        showError('Error updating request');
                    };
                }
            };
        });

        // Initiate payment
        function initiatePayment(requestId) {
            const transaction = db.transaction(['requests', 'products', 'brands'], 'readwrite');
            const requestsStore = transaction.objectStore('requests');
            const productsStore = transaction.objectStore('products');
            const brandsStore = transaction.objectStore('brands');
            
            const requestRequest = requestsStore.get(parseInt(requestId));
            
            requestRequest.onsuccess = function() {
                const request = requestRequest.result;
                if (request && request.status === 'approved' && request.quote) {
                    // Get product and brand info
                    const productRequest = productsStore.get(request.productId);
                    const brandRequest = brandsStore.get(request.brandId);
                    
                    Promise.all([productRequest, brandRequest].map(req => {
                        return new Promise(resolve => {
                            req.onsuccess = () => resolve(req.result);
                        });
                    })).then(([product, brand]) => {
                        // Create order
                        const ordersTransaction = db.transaction(['orders'], 'readwrite');
                        const ordersStore = ordersTransaction.objectStore('orders');
                        
                        const order = {
                            userId: request.userId,
                            brandId: request.brandId,
                            requestId: request.id,
                            productId: request.productId,
                            amount: request.quote,
                            status: 'paid',
                            trackingNumber: '',
                            createdAt: new Date().toISOString()
                        };
                        
                        const addOrder = ordersStore.add(order);
                        
                        addOrder.onsuccess = function() {
                            // Create transaction
                            const transactionsTransaction = db.transaction(['transactions', 'settings'], 'readwrite');
                            const transactionsStore = transactionsTransaction.objectStore('transactions');
                            const settingsStore = transactionsTransaction.objectStore('settings');
                            
                            // Get platform commission rate
                            const settingsRequest = settingsStore.get('platform');
                            
                            settingsRequest.onsuccess = function() {
                                const settings = settingsRequest.result;
                                const commissionRate = settings ? settings.commissionRate : 2.5; // Default to 2.5%
                                const commission = request.quote * (commissionRate / 100);
                                
                                const transaction = {
                                    orderId: addOrder.result,
                                    userId: request.userId,
                                    brandId: request.brandId,
                                    amount: request.quote,
                                    commission: commission,
                                    date: new Date().toISOString()
                                };
                                
                                const addTransaction = transactionsStore.add(transaction);
                                
                                addTransaction.onsuccess = function() {
                                    // Update request status to completed
                                    request.status = 'completed';
                                    const updateRequest = requestsStore.put(request);
                                    
                                    updateRequest.onsuccess = function() {
                                        hideModal('requestDetailModal');
                                        showSuccess('Payment processed successfully!');
                                        
                                        // Refresh user dashboard
                                        const loggedInUser = JSON.parse(localStorage.getItem('loggedInUser'));
                                        if (loggedInUser) {
                                            loadUserData(loggedInUser.id);
                                        }
                                    };
                                };
                            };
                        };
                    });
                }
            };
        }

        // Fulfill order
        function fulfillOrder(orderId) {
            const trackingNumber = prompt('Enter tracking number:');
            if (!trackingNumber) return;
            
            const transaction = db.transaction(['orders'], 'readwrite');
            const ordersStore = transaction.objectStore('orders');
            
            const getOrder = ordersStore.get(parseInt(orderId));
            
            getOrder.onsuccess = function() {
                const order = getOrder.result;
                if (order) {
                    order.status = 'completed';
                    order.trackingNumber = trackingNumber;
                    
                    const updateOrder = ordersStore.put(order);
                    
                    updateOrder.onsuccess = function() {
                        showSuccess('Order marked as completed!');
                        
                        // Refresh brand orders
                        const loggedInBrand = JSON.parse(localStorage.getItem('loggedInBrand'));
                        if (loggedInBrand) {
                            loadBrandOrders();
                        }
                    };
                }
            };
        }

        // Add new product
        function addNewProduct() {
            const loggedInBrand = JSON.parse(localStorage.getItem('loggedInBrand'));
            if (!loggedInBrand) return;
            
            const name = document.getElementById('productName').value;
            const category = document.getElementById('productCategory').value;
            const description = document.getElementById('productDescription').value;
            const basePrice = parseFloat(document.getElementById('productBasePrice').value);
            const customOptions = document.getElementById('productCustomOptions').value;
            const images = document.getElementById('productImages').files;
            
            if (!name || !category || !description || isNaN(basePrice) || basePrice <= 0) {
                showError('Please fill in all required fields with valid values');
                return;
            }
            
            // Convert images to base64
            const imagePromises = Array.from(images).map(file => {
                return new Promise(resolve => {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        resolve(event.target.result.split(',')[1]);
                    };
                    reader.readAsDataURL(file);
                });
            });
            
            Promise.all(imagePromises).then(imageData => {
                const transaction = db.transaction(['products'], 'readwrite');
                const productsStore = transaction.objectStore('products');
                
                const product = {
                    brandId: loggedInBrand.id,
                    name: name,
                    category: category,
                    description: description,
                    basePrice: basePrice,
                    images: imageData,
                    customizationOptions: customOptions,
                    createdAt: new Date().toISOString()
                };
                
                const addRequest = productsStore.add(product);
                
                addRequest.onsuccess = function() {
                    hideModal('addProductModal');
                    showSuccess('Product added successfully!');
                    
                    // Refresh brand products
                    loadBrandProducts();
                };
                
                addRequest.onerror = function() {
                    showError('Error adding product');
                };
            });
        }

        // Delete product
        function deleteProduct(productId) {
            const transaction = db.transaction(['products'], 'readwrite');
            const productsStore = transaction.objectStore('products');
            
            const deleteRequest = productsStore.delete(parseInt(productId));
            
            deleteRequest.onsuccess = function() {
                showSuccess('Product deleted successfully!');
                
                // Refresh brand products
                loadBrandProducts();
            };
            
            deleteRequest.onerror = function() {
                showError('Error deleting product');
            };
        }

        // Add new brand
        function addNewBrand() {
            const name = document.getElementById('newBrandName').value;
            const email = document.getElementById('newBrandEmail').value;
            const password = document.getElementById('newBrandPassword').value;
            const description = document.getElementById('newBrandDescription').value;
            const categories = Array.from(document.getElementById('newBrandCategories').selectedOptions).map(opt => opt.value);
            const logo = document.getElementById('newBrandLogo').files[0];
            
            if (!name || !email || !password || !description || categories.length === 0) {
                showError('Please fill in all required fields');
                return;
            }
            
            // Check if email already exists
            const checkTransaction = db.transaction(['brands'], 'readonly');
            const brandsStore = checkTransaction.objectStore('brands');
            const emailIndex = brandsStore.index('email');
            const checkRequest = emailIndex.get(email);
            
            checkRequest.onsuccess = function() {
                if (checkRequest.result) {
                    showError('Email already registered for another brand');
                } else {
                    // Convert logo to base64 if exists
                    if (logo) {
                        const reader = new FileReader();
                        reader.onload = function(event) {
                            const logoBase64 = event.target.result.split(',')[1];
                            addBrand(logoBase64);
                        };
                        reader.readAsDataURL(logo);
                    } else {
                        addBrand(null);
                    }
                }
            };
            
            function addBrand(logoBase64) {
                const transaction = db.transaction(['brands'], 'readwrite');
                const brandsStore = transaction.objectStore('brands');
                
                const brand = {
                    name: name,
                    email: email,
                    password: password,
                    description: description,
                    logo: logoBase64,
                    categories: categories,
                    bankDetails: {
                        bankName: '',
                        accountName: '',
                        accountNumber: '',
                        routingNumber: ''
                    },
                    createdAt: new Date().toISOString()
                };
                
                const addRequest = brandsStore.add(brand);
                
                addRequest.onsuccess = function() {
                    hideModal('addBrandModal');
                    showSuccess('Brand added successfully!');
                    
                    // Refresh admin brands
                    loadAllBrands();
                };
                
                addRequest.onerror = function() {
                    showError('Error adding brand');
                };
            }
        }

        // Show brand details
        function showBrandDetails(brandId) {
            const transaction = db.transaction(['brands'], 'readonly');
            const brandsStore = transaction.objectStore('brands');
            
            const brandRequest = brandsStore.get(parseInt(brandId));
            
            brandRequest.onsuccess = function() {
                const brand = brandRequest.result;
                if (brand) {
                    document.getElementById('adminBrandId').value = 'BR-' + brand.id.toString().padStart(5, '0');
                    document.getElementById('adminBrandName').value = brand.name;
                    document.getElementById('adminBrandEmail').value = brand.email;
                    document.getElementById('adminBrandDescription').value = brand.description;
                    document.getElementById('adminBrandStatus').value = 'active'; // In a real app, this would come from the brand data
                    document.getElementById('adminBrandJoined').value = formatDate(brand.createdAt);
                    
                    // Categories
                    const categoriesDiv = document.getElementById('adminBrandCategories');
                    categoriesDiv.innerHTML = '';
                    if (brand.categories && brand.categories.length > 0) {
                        brand.categories.forEach(category => {
                            const span = document.createElement('span');
                            span.style.background = 'rgba(108, 92, 231, 0.1)';
                            span.style.padding = '5px 10px';
                            span.style.borderRadius = '12px';
                            span.style.fontSize = '12px';
                            span.textContent = category;
                            categoriesDiv.appendChild(span);
                        });
                    }
                    
                    // Logo
                    if (brand.logo) {
                        document.getElementById('adminBrandLogo').src = 'data:image/png;base64,' + brand.logo;
                    } else {
                        document.getElementById('adminBrandLogo').src = '';
                    }
                    
                    // Revenue and commission (would need to calculate from transactions)
                    document.getElementById('adminBrandRevenue').value = '$0'; // In a real app, this would be calculated
                    document.getElementById('adminBrandCommission').value = '$0'; // In a real app, this would be calculated
                    
                    // Store brand ID for saving
                    document.getElementById('saveAdminBrandBtn').setAttribute('data-brand-id', brand.id);
                    
                    showModal('brandDetailModal');
                }
            };
        }

        // Show user details
        function showUserDetails(userId) {
            const transaction = db.transaction(['users', 'requests', 'orders'], 'readonly');
            const usersStore = transaction.objectStore('users');
            const requestsStore = transaction.objectStore('requests');
            const ordersStore = transaction.objectStore('orders');
            
            const userRequest = usersStore.get(parseInt(userId));
            
            userRequest.onsuccess = function() {
                const user = userRequest.result;
                if (user) {
                    document.getElementById('adminUserId').value = 'USR-' + user.id.toString().padStart(5, '0');
                    document.getElementById('adminUserName').value = user.name;
                    document.getElementById('adminUserEmail').value = user.email;
                    document.getElementById('adminUserPhone').value = user.phone || '';
                    document.getElementById('adminUserAddress').value = user.address || '';
                    document.getElementById('adminUserJoined').value = formatDate(user.createdAt);
                    document.getElementById('adminUserStatus').value = 'active'; // In a real app, this would come from user data
                    
                    // Count requests and orders
                    const userRequestsIndex = requestsStore.index('userId');
                    const requestsCountRequest = userRequestsIndex.count(user.id);
                    
                    const userOrdersIndex = ordersStore.index('userId');
                    const ordersCountRequest = userOrdersIndex.count(user.id);
                    
                    Promise.all([
                        new Promise(resolve => {
                            requestsCountRequest.onsuccess = () => resolve(requestsCountRequest.result);
                        }),
                        new Promise(resolve => {
                            ordersCountRequest.onsuccess = () => resolve(ordersCountRequest.result);
                        })
                    ]).then(([requestsCount, ordersCount]) => {
                        document.getElementById('adminUserOrders').value = ordersCount;
                        
                        // Calculate total spent (would need to sum order amounts in a real app)
                        document.getElementById('adminUserSpent').value = '$0'; // Placeholder
                    });
                    
                    // Store user ID for saving
                    document.getElementById('saveAdminUserBtn').setAttribute('data-user-id', user.id);
                    
                    showModal('userDetailModal');
                }
            };
        }

        // Update user profile
        function updateUserProfile(e) {
            e.preventDefault();
            
            const loggedInUser = JSON.parse(localStorage.getItem('loggedInUser'));
            if (!loggedInUser) return;
            
            const name = document.getElementById('settingsName').value;
            const email = document.getElementById('settingsEmail').value;
            const phone = document.getElementById('settingsPhone').value;
            const address = document.getElementById('settingsAddress').value;
            
            if (!name || !email) {
                showError('Name and email are required');
                return;
            }
            
            const transaction = db.transaction(['users'], 'readwrite');
            const usersStore = transaction.objectStore('users');
            
            const getRequest = usersStore.get(loggedInUser.id);
            
            getRequest.onsuccess = function() {
                const user = getRequest.result;
                if (user) {
                    // Check if email is being changed to one that already exists
                    if (email !== user.email) {
                        const emailIndex = usersStore.index('email');
                        const checkRequest = emailIndex.get(email);
                        
                        checkRequest.onsuccess = function() {
                            if (checkRequest.result) {
                                showError('Email already registered');
                            } else {
                                updateUser();
                            }
                        };
                    } else {
                        updateUser();
                    }
                }
            };
            
            function updateUser() {
                const getRequest = usersStore.get(loggedInUser.id);
                
                getRequest.onsuccess = function() {
                    const user = getRequest.result;
                    if (user) {
                        user.name = name;
                        user.email = email;
                        user.phone = phone;
                        user.address = address;
                        
                        const updateRequest = usersStore.put(user);
                        
                        updateRequest.onsuccess = function() {
                            // Update logged in user in localStorage
                            localStorage.setItem('loggedInUser', JSON.stringify(user));
                            document.getElementById('sidebarUsername').textContent = user.name;
                            
                            showSuccess('Profile updated successfully!');
                        };
                        
                        updateRequest.onerror = function() {
                            showError('Error updating profile');
                        };
                    }
                };
            }
        }

        // Change password
        function changePassword(e) {
            e.preventDefault();
            
            const loggedInUser = JSON.parse(localStorage.getItem('loggedInUser'));
            if (!loggedInUser) return;
            
            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            if (!currentPassword || !newPassword || !confirmPassword) {
                showError('Please fill in all fields');
                return;
            }
            
            if (newPassword !== confirmPassword) {
                showError('New passwords do not match');
                return;
            }
            
            if (currentPassword !== loggedInUser.password) {
                showError('Current password is incorrect');
                return;
            }
            
            const transaction = db.transaction(['users'], 'readwrite');
            const usersStore = transaction.objectStore('users');
            
            const getRequest = usersStore.get(loggedInUser.id);
            
            getRequest.onsuccess = function() {
                const user = getRequest.result;
                if (user) {
                    user.password = newPassword;
                    
                    const updateRequest = usersStore.put(user);
                    
                    updateRequest.onsuccess = function() {
                        // Update logged in user in localStorage
                        loggedInUser.password = newPassword;
                        localStorage.setItem('loggedInUser', JSON.stringify(loggedInUser));
                        
                        document.getElementById('currentPassword').value = '';
                        document.getElementById('newPassword').value = '';
                        document.getElementById('confirmPassword').value = '';
                        
                        showSuccess('Password changed successfully!');
                    };
                    
                    updateRequest.onerror = function() {
                        showError('Error changing password');
                    };
                }
            };
        }

        // Update brand profile
        function updateBrandProfile(e) {
            e.preventDefault();
            
            const loggedInBrand = JSON.parse(localStorage.getItem('loggedInBrand'));
            if (!loggedInBrand) return;
            
            const name = document.getElementById('brandName').value;
            const description = document.getElementById('brandDescription').value;
            const categories = Array.from(document.getElementById('brandCategories').selectedOptions).map(opt => opt.value);
            const logo = document.getElementById('brandLogo').files[0];
            
            if (!name || !description || categories.length === 0) {
                showError('Please fill in all required fields');
                return;
            }
            
            const transaction = db.transaction(['brands'], 'readwrite');
            const brandsStore = transaction.objectStore('brands');
            
            const getRequest = brandsStore.get(loggedInBrand.id);
            
            getRequest.onsuccess = function() {
                const brand = getRequest.result;
                if (brand) {
                    // Convert logo to base64 if exists
                    if (logo) {
                        const reader = new FileReader();
                        reader.onload = function(event) {
                            const logoBase64 = event.target.result.split(',')[1];
                            updateBrand(logoBase64);
                        };
                        reader.readAsDataURL(logo);
                    } else {
                        // Keep existing logo if no new one uploaded
                        updateBrand(brand.logo);
                    }
                }
            };
            
            function updateBrand(logoBase64) {
                const getRequest = brandsStore.get(loggedInBrand.id);
                
                getRequest.onsuccess = function() {
                    const brand = getRequest.result;
                    if (brand) {
                        brand.name = name;
                        brand.description = description;
                        brand.categories = categories;
                        brand.logo = logoBase64;
                        
                        const updateRequest = brandsStore.put(brand);
                        
                        updateRequest.onsuccess = function() {
                            // Update logged in brand in localStorage
                            localStorage.setItem('loggedInBrand', JSON.stringify(brand));
                            document.getElementById('brandSidebarName').textContent = brand.name;
                            
                            // Update logo preview
                            if (logoBase64) {
                                document.getElementById('brandLogoPreview').src = 'data:image/png;base64,' + logoBase64;
                                document.getElementById('brandLogoPreview').style.display = 'block';
                            }
                            
                            showSuccess('Brand profile updated successfully!');
                        };
                        
                        updateRequest.onerror = function() {
                            showError('Error updating brand profile');
                        };
                    }
                };
            }
        }

        // Update brand payment info
        function updateBrandPaymentInfo(e) {
            e.preventDefault();
            
            const loggedInBrand = JSON.parse(localStorage.getItem('loggedInBrand'));
            if (!loggedInBrand) return;
            
            const bankName = document.getElementById('bankName').value;
            const accountName = document.getElementById('accountName').value;
            const accountNumber = document.getElementById('accountNumber').value;
            const routingNumber = document.getElementById('routingNumber').value;
            
            if (!bankName || !accountName || !accountNumber || !routingNumber) {
                showError('Please fill in all fields');
                return;
            }
            
            const transaction = db.transaction(['brands'], 'readwrite');
            const brandsStore = transaction.objectStore('brands');
            
            const getRequest = brandsStore.get(loggedInBrand.id);
            
            getRequest.onsuccess = function() {
                const brand = getRequest.result;
                if (brand) {
                    brand.bankDetails = {
                        bankName: bankName,
                        accountName: accountName,
                        accountNumber: accountNumber,
                        routingNumber: routingNumber
                    };
                    
                    const updateRequest = brandsStore.put(brand);
                    
                    updateRequest.onsuccess = function() {
                        // Update logged in brand in localStorage
                        localStorage.setItem('loggedInBrand', JSON.stringify(brand));
                        
                        showSuccess('Payment information updated successfully!');
                    };
                    
                    updateRequest.onerror = function() {
                        showError('Error updating payment information');
                    };
                }
            };
        }

        // Update platform settings
        function updatePlatformSettings(e) {
            e.preventDefault();
            
            const name = document.getElementById('platformName').value;
            const commissionRate = parseFloat(document.getElementById('platformCommission').value);
            const currency = document.getElementById('platformCurrency').value;
            const logo = document.getElementById('platformLogo').files[0];
            
            if (!name || isNaN(commissionRate) || commissionRate <= 0 || !currency) {
                showError('Please fill in all fields with valid values');
                return;
            }
            
            const transaction = db.transaction(['settings'], 'readwrite');
            const settingsStore = transaction.objectStore('settings');
            
            const getRequest = settingsStore.get('platform');
            
            getRequest.onsuccess = function() {
                const settings = getRequest.result;
                if (settings) {
                    // Convert logo to base64 if exists
                    if (logo) {
                        const reader = new FileReader();
                        reader.onload = function(event) {
                            const logoBase64 = event.target.result.split(',')[1];
                            updateSettings(logoBase64);
                        };
                        reader.readAsDataURL(logo);
                    } else {
                        // Keep existing logo if no new one uploaded
                        updateSettings(settings.logo);
                    }
                }
            };
            
            function updateSettings(logoBase64) {
                const getRequest = settingsStore.get('platform');
                
                getRequest.onsuccess = function() {
                    const settings = getRequest.result;
                    if (settings) {
                        settings.name = name;
                        settings.commissionRate = commissionRate;
                        settings.currency = currency;
                        settings.logo = logoBase64;
                        settings.updatedAt = new Date().toISOString();
                        
                        const updateRequest = settingsStore.put(settings);
                        
                        updateRequest.onsuccess = function() {
                            // Update logo preview
                            if (logoBase64) {
                                document.getElementById('platformLogoPreview').src = 'data:image/png;base64,' + logoBase64;
                                document.getElementById('platformLogoPreview').style.display = 'block';
                            }
                            
                            showSuccess('Platform settings updated successfully!');
                        };
                        
                        updateRequest.onerror = function() {
                            showError('Error updating platform settings');
                        };
                    }
                };
            }
        }

        // Update payment settings
        function updatePaymentSettings(e) {
            e.preventDefault();
            
            const paymentMethods = Array.from(document.querySelectorAll('input[name="paymentMethods"]:checked')).map(checkbox => checkbox.value);
            const stripeKey = document.getElementById('stripeKey').value;
            const paypalKey = document.getElementById('paypalKey').value;
            
            const transaction = db.transaction(['settings'], 'readwrite');
            const settingsStore = transaction.objectStore('settings');
            
            const getRequest = settingsStore.get('platform');
            
            getRequest.onsuccess = function() {
                const settings = getRequest.result;
                if (settings) {
                    settings.paymentMethods = paymentMethods;
                    settings.stripeKey = stripeKey;
                    settings.paypalKey = paypalKey;
                    settings.updatedAt = new Date().toISOString();
                    
                    const updateRequest = settingsStore.put(settings);
                    
                    updateRequest.onsuccess = function() {
                        showSuccess('Payment settings updated successfully!');
                    };
                    
                    updateRequest.onerror = function() {
                        showError('Error updating payment settings');
                    };
                }
            };
        }

        // Format date
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'short',
                day: 'numeric'
            });
        }

        // Initialize file upload previews
        document.getElementById('brandLogo').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    const preview = document.getElementById('brandLogoPreview');
                    preview.src = event.target.result;
                    preview.style.display = 'block';
                };
                reader.readAsDataURL(file);
            }
        });
        
        document.getElementById('newBrandLogo').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    const preview = document.getElementById('newBrandLogoPreview');
                    preview.src = event.target.result;
                    preview.style.display = 'block';
                };
                reader.readAsDataURL(file);
            }
        });
        
        document.getElementById('platformLogo').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    const preview = document.getElementById('platformLogoPreview');
                    preview.src = event.target.result;
                    preview.style.display = 'block';
                };
                reader.readAsDataURL(file);
            }
        });
        
        document.getElementById('productImages').addEventListener('change', function(e) {
            const files = e.target.files;
            const previewDiv = document.getElementById('productImagesPreview');
            previewDiv.innerHTML = '';
            
            if (files && files.length > 0) {
                Array.from(files).forEach(file => {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        const img = document.createElement('img');
                        img.src = event.target.result;
                        img.style.maxWidth = '100px';
                        img.style.maxHeight = '100px';
                        img.style.margin = '5px';
                        previewDiv.appendChild(img);
                    };
                    reader.readAsDataURL(file);
                });
            }
        });


   
    </script>
    <script src="script.js"></script>
</body>
</html>